var LiteGUI={root:null,content:null,panels:{},undo_steps:[],modalbg_div:null,_modules_initialized:!1,mainmenu:null,modules:[],init:function(c){c=c||{};c.width&&c.height&&this.setWindowSize(c.width,c.height);this.container=null;c.container&&(this.container=document.getElementById(c.container));this.container||(this.container=document.body);var b=document.createElement("div");b.className="litegui-wrap fullscreen";b.style.position="relative";b.style.overflow="hidden";this.root=b;this.container.appendChild(b);
b=this.modalbg_div=document.createElement("div");this.modalbg_div.className="litemodalbg";this.root.appendChild(this.modalbg_div);b.style.display="none";b=document.createElement("div");b.className="litegui-maincontent";this.content=b;this.root.appendChild(b);c.menubar&&this.createMenubar();c.gui_callback&&c.gui_callback();!1!=c.initModules&&this.initModules();this.root.classList.contains("fullscreen")&&window.addEventListener("resize",function(a){LiteGUI.maximizeWindow()});document.addEventListener("keydown",
function(a){"input"!=a.target.nodeName.toLowerCase()&&"textarea"!=a.target.nodeName.toLowerCase()&&17!=a.keyCode&&((26==a.keyCode||90==a.keyCode&&(a.ctrlKey||a.metaKey)||122==a.charCode&&a.ctrlKey)&&LiteGUI.doUndo(),27==a.keyCode&&$(LiteGUI).trigger("escape"))});window.onbeforeunload=this.onUnload.bind(this)},initModules:function(){for(var c in this.modules)this.modules[c].preInit&&this.modules[c].preInit();for(c in this.modules)this.modules[c].init&&!this.modules[c]._initialized&&(this.modules[c].init(),
this.modules[c]._initialized=!0);for(c in this.modules)this.modules[c].postInit&&this.modules[c].postInit();this._modules_initialized=!0},registerModule:function(c){this.modules.push(c);this._modules_initialized&&(c.preInit&&c.preInit(),c.init&&c.init(),c.postInit&&c.postInit());$(this).trigger("module_registered",c)},onUnload:function(){for(var c in this.modules)if(this.modules[c].onUnload)this.modules[c].onUnload()},add:function(c){this.content.appendChild(c.root||c)},getById:function(c){return document.getElementById(c)},
createMenubar:function(){this.menubar=new LiteGUI.Menubar("mainmenubar");this.add(this.menubar)},setWindowSize:function(c,b){if(c&&b)$(this.root).css({width:c+"px",height:b+"px","box-shadow":"0 0 4px black"}).removeClass("fullscreen");else{if($(this.root).hasClass("fullscreen"))return;$(this.root).addClass("fullscreen");$(this.root).css({width:"100%",height:"100%","box-shadow":"0 0 0"})}$(LiteGUI).trigger("resized")},maximizeWindow:function(){this.setWindowSize()},setCursor:function(c){this.root.style.cursor=
c},max_undo_steps:100,min_time_between_undos:500,last_undo_time:0,addUndoStep:function(c){var b=(new Date).getTime();b-this.last_undo_time<this.min_time_between_undos||(this.undo_steps.push(c),this.last_undo_time=b,this.undo_steps.length>this.max_undo_steps&&this.undo_steps.shift())},doUndo:function(){if(this.undo_steps.length){var c=this.undo_steps.pop();null!=c.callback&&c.callback(c.data);$(LiteGUI).trigger("undo",c)}},removeUndoSteps:function(){this.undo_steps=[]},toClipboard:function(c){null!=
c&&localStorage.setItem("lite_clipboard",JSON.stringify(c))},getClipboard:function(){var c=localStorage.getItem("lite_clipboard");return c?JSON.parse(c):null},addCSS:function(c){var b=document.createElement("style");b.type="text/css";b.innerHTML=c;document.getElementsByTagName("head")[0].appendChild(b)},requireCSS:function(c,b){for("string"==typeof c&&(c=[c]);c.length;){var a=document.createElement("link");a.rel="stylesheet";a.type="text/css";a.href=c.shift(1);a.media="all";document.getElementsByTagName("head")[0].appendChild(a);
0==c.length&&(a.onload=b)}},request:function(c){var b=c.dataType||"text";"json"==b?b="text":"xml"==b?b="text":"binary"==b&&(b="arraybuffer",c.mimeType="application/octet-stream");var a=new XMLHttpRequest;a.open(c.data?"POST":"GET",c.url,!0);b&&(a.responseType=b);c.mimeType&&a.overrideMimeType(c.mimeType);a.onload=function(b){b=this.response;if(200!=this.status)b="Error "+this.status,c.error&&c.error(b),LEvent.trigger(a,"fail",this.status);else{if("json"==c.dataType)try{b=JSON.parse(b)}catch(g){if(c.error)c.error(g);
else throw g;}else if("xml"==c.dataType)try{b=(new DOMParser).parseFromString(b,"text/xml")}catch(d){if(c.error)c.error(d);else throw d;}c.success&&c.success.call(this,b)}};a.onerror=function(a){c.error&&c.error(a)};a.send(c.data);return a},requireScript:function(c,b,a,e){"string"==typeof c&&(c=[c]);var g=c.length,d;for(d in c){var f=document.createElement("script");f.num=d;f.type="text/javascript";f.src=c[d];f.async=!1;f.onload=function(e){g--;g?a&&a(this.src,this.num):b&&b()};e&&(f.onerror=function(a){e(a,
this.src,this.num)});document.getElementsByTagName("head")[0].appendChild(f)}},requireScriptSerial:function(c,b,a){function e(){var g=document.createElement("script");g.type="text/javascript";g.src=c.shift(1);g.onload=function(g){c.length?(a&&a(c[0],c.length),e()):b&&b()};document.getElementsByTagName("head")[0].appendChild(g)}"string"==typeof c&&(c=[c]);e()},newDiv:function(c,b){var a=document.createElement("div");a.id=c;a.root=a;void 0!==b&&(a.innerHTML=b);a.add=function(a){this.appendChild(a.root||
a)};return a},newWindow:function(c,b,a,e){e=e||{};b=window.open("","","width="+b+", height="+a+", location=no, status=no, menubar=no, titlebar=no, fullscreen=yes");b.document.write("<html><head><title>"+c+"</title>");a=document.querySelectorAll("link[rel='stylesheet'],style");for(c=0;c<a.length;c++)b.document.write(a[c].outerHTML);if(e.scripts)for(a=document.querySelectorAll("script"),c=0;c<a.length;c++)a[c].src&&b.document.write(a[c].outerHTML);b.document.write("</head><body>"+(e.content||"")+"</body></html>");
b.document.close();return b},showModalBackground:function(c){LiteGUI.modalbg_div.style.display=c?"block":"none"},showMessage:function(c,b){b=b||{};b.title=b.title||"Attention";b.content=c;b.close="fade";var a=new LiteGUI.Dialog("info_message",b);b.noclose||a.addButton("Close",{close:!0});a.makeModal("fade");return a},popup:function(c,b){b=b||{};b.min_height=140;"string"==typeof c&&(c="<p>"+c+"</p>");b.content=c;b.close="fade";var a=new LiteGUI.Dialog("info_message",b);b.noclose||a.addButton("Close",
{close:!0});a.show();return a},alert:function(c,b){b=b||{};b.className="alert";b.title="Alert";b.width=280;b.height=140;"string"==typeof c&&(c="<p>"+c+"</p>");$(".litepanel.alert").remove();return this.showMessage(c,b)},confirm:function(c,b,a){a=a||{};a.className="alert";a.title="Confirm";a.width=280;"string"==typeof c&&(c="<p>"+c+"</p>");a.noclose=!0;var e=this.showMessage(c+"<button data-value='yes' style='width:45%; margin-left: 10px'>Yes</button><button data-value='no' style='width:45%'>No</button>",
a);e.content.style.paddingBottom="10px";e.content.querySelector("button").addEventListener("click",function(){var a="yes"==this.dataset.value;b&&b(a);e.close()});return e},prompt:function(c,b,a){a=a||{};a.className="alert";a.title="Prompt";a.width=280;"string"==typeof c&&(c="<p>"+c+"</p>");var e=a.value||"",g="<input type='text' value='"+e+"'/>";a.textarea&&(g="<textarea class='textfield' style='width:95%'>"+e+"</textarea>");a.noclose=!0;var d=this.showMessage(c+("<p>"+g+"</p><button data-value='accept' style='width:45%; margin-left: 10px; margin-bottom: 10px'>Accept</button><button data-value='cancel' style='width:45%'>Cancel</button>"),
a);d.content.querySelector("button").addEventListener("click",function(){var e=$(d.content).find(a.textarea?"textarea":"input").val();"cancel"==this.dataset.value&&(e=null);b&&b(e);d.close()});d.content.querySelector("input,textarea").focus();return d},getUrlVars:function(){for(var c=[],b,a=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),e=0;e<a.length;e++)b=a[e].split("="),c.push(b[0]),c[b[0]]=b[1];return c},getUrlVar:function(c){return LiteGUI.getUrlVars()[c]},focus:function(c){c.focus()},
trigger:function(c,b,a){var e=document.createEvent("CustomEvent");e.initCustomEvent(b,!0,!0,a);if(c.dispatchEvent)c.dispatchEvent(e);else throw"trigger can only be called in DOMElements";},draggable:function(c,b){function a(b){if("mousedown"==b.type)return d||(f=(d=c.getClientRects()[0])?d.left:0,h=d?d.top:0),e=b.clientX,g=b.clientY,document.addEventListener("mousemove",a),document.addEventListener("mouseup",a),b.stopPropagation(),b.preventDefault(),!1;if("mouseup"==b.type)document.removeEventListener("mousemove",
a),document.removeEventListener("mouseup",a);else if("mousemove"==b.type){var m=b.clientX-e,p=b.clientY-g;e=b.clientX;g=b.clientY;f+=m;h+=p;c.style.left=f+"px";c.style.top=h+"px"}}b=b||c;b.addEventListener("mousedown",a);b.style.cursor="move";var e=0,g=0,d=c.getClientRects()[0],f=d?d.left:0,h=d?d.top:0;c.style.position="absolute";c.style.left=f+"px";c.style.top=h+"px"},cloneObject:function(c,b){var a=b||{},e;for(e in c)if("_"!=e[0]&&"jQuery"!=e.substr(0,6)){var g=c[e];if(null==g)a[e]=null;else if(!isFunction(g))if("number"==
typeof g||"string"==typeof g)a[e]=g;else if(g.constructor==Float32Array)a[e]=Array.apply([],g);else if(isArray(g))a[e]&&a[e].constructor==Float32Array?a[e].set(g):a[e]=JSON.parse(JSON.stringify(g));else try{a[e]=JSON.parse(JSON.stringify(g))}catch(d){console.error(d)}}return a}};function purgeElement(c,b){var a=c.attributes,e,g;if(a)for(e=a.length-1;0<=e;e-=1)g=a[e].name,"function"===typeof c[g]&&(c[g]=null);if(a=c.childNodes)for(a=a.length,e=0;e<a;e+=1)purgeElement(c.childNodes[e])}
"undefined"==typeof escapeHtmlEntities&&(escapeHtmlEntities=function(c){return c.replace(/[\u00A0-\u2666<>\&]/g,function(b){return"&"+(escapeHtmlEntities.entityTable[b.charCodeAt(0)]||"#"+b.charCodeAt(0))+";"})},escapeHtmlEntities.entityTable={34:"quot",38:"amp",39:"apos",60:"lt",62:"gt",160:"nbsp",161:"iexcl",162:"cent",163:"pound",164:"curren",165:"yen",166:"brvbar",167:"sect",168:"uml",169:"copy",170:"ordf",171:"laquo",172:"not",173:"shy",174:"reg",175:"macr",176:"deg",177:"plusmn",178:"sup2",
179:"sup3",180:"acute",181:"micro",182:"para",183:"middot",184:"cedil",185:"sup1",186:"ordm",187:"raquo",188:"frac14",189:"frac12",190:"frac34",191:"iquest",192:"Agrave",193:"Aacute",194:"Acirc",195:"Atilde",196:"Auml",197:"Aring",198:"AElig",199:"Ccedil",200:"Egrave",201:"Eacute",202:"Ecirc",203:"Euml",204:"Igrave",205:"Iacute",206:"Icirc",207:"Iuml",208:"ETH",209:"Ntilde",210:"Ograve",211:"Oacute",212:"Ocirc",213:"Otilde",214:"Ouml",215:"times",216:"Oslash",217:"Ugrave",218:"Uacute",219:"Ucirc",
220:"Uuml",221:"Yacute",222:"THORN",223:"szlig",224:"agrave",225:"aacute",226:"acirc",227:"atilde",228:"auml",229:"aring",230:"aelig",231:"ccedil",232:"egrave",233:"eacute",234:"ecirc",235:"euml",236:"igrave",237:"iacute",238:"icirc",239:"iuml",240:"eth",241:"ntilde",242:"ograve",243:"oacute",244:"ocirc",245:"otilde",246:"ouml",247:"divide",248:"oslash",249:"ugrave",250:"uacute",251:"ucirc",252:"uuml",253:"yacute",254:"thorn",255:"yuml",402:"fnof",913:"Alpha",914:"Beta",915:"Gamma",916:"Delta",917:"Epsilon",
918:"Zeta",919:"Eta",920:"Theta",921:"Iota",922:"Kappa",923:"Lambda",924:"Mu",925:"Nu",926:"Xi",927:"Omicron",928:"Pi",929:"Rho",931:"Sigma",932:"Tau",933:"Upsilon",934:"Phi",935:"Chi",936:"Psi",937:"Omega",945:"alpha",946:"beta",947:"gamma",948:"delta",949:"epsilon",950:"zeta",951:"eta",952:"theta",953:"iota",954:"kappa",955:"lambda",956:"mu",957:"nu",958:"xi",959:"omicron",960:"pi",961:"rho",962:"sigmaf",963:"sigma",964:"tau",965:"upsilon",966:"phi",967:"chi",968:"psi",969:"omega",977:"thetasym",
978:"upsih",982:"piv",8226:"bull",8230:"hellip",8242:"prime",8243:"Prime",8254:"oline",8260:"frasl",8472:"weierp",8465:"image",8476:"real",8482:"trade",8501:"alefsym",8592:"larr",8593:"uarr",8594:"rarr",8595:"darr",8596:"harr",8629:"crarr",8656:"lArr",8657:"uArr",8658:"rArr",8659:"dArr",8660:"hArr",8704:"forall",8706:"part",8707:"exist",8709:"empty",8711:"nabla",8712:"isin",8713:"notin",8715:"ni",8719:"prod",8721:"sum",8722:"minus",8727:"lowast",8730:"radic",8733:"prop",8734:"infin",8736:"ang",8743:"and",
8744:"or",8745:"cap",8746:"cup",8747:"int",8756:"there4",8764:"sim",8773:"cong",8776:"asymp",8800:"ne",8801:"equiv",8804:"le",8805:"ge",8834:"sub",8835:"sup",8836:"nsub",8838:"sube",8839:"supe",8853:"oplus",8855:"otimes",8869:"perp",8901:"sdot",8968:"lceil",8969:"rceil",8970:"lfloor",8971:"rfloor",9001:"lang",9002:"rang",9674:"loz",9824:"spades",9827:"clubs",9829:"hearts",9830:"diams",338:"OElig",339:"oelig",352:"Scaron",353:"scaron",376:"Yuml",710:"circ",732:"tilde",8194:"ensp",8195:"emsp",8201:"thinsp",
8204:"zwnj",8205:"zwj",8206:"lrm",8207:"rlm",8211:"ndash",8212:"mdash",8216:"lsquo",8217:"rsquo",8218:"sbquo",8220:"ldquo",8221:"rdquo",8222:"bdquo",8224:"dagger",8225:"Dagger",8240:"permil",8249:"lsaquo",8250:"rsaquo",8364:"euro"});
function beautifyCode(c,b){b=b||"abstract else instanceof super boolean enum int switch break export interface synchronized byte extends let this case false long throw catch final native throws char finally new transient class float null true const for package try continue function private typeof debugger goto protected var default if public void delete implements return volatile do import short while double in static with".split(" ");c=c.replace(/(\w+)/g,function(a){return-1!=b.indexOf(a)?"<span class='rsv'>"+
a+"</span>":a});c=c.replace(/([0-9]+)/g,function(a){return"<span class='num'>"+a+"</span>"});c=c.replace(/(\w+\.\w+)/g,function(a){a=a.split(".");return"<span class='obj'>"+a[0]+"</span>.<span class='prop'>"+a[1]+"</span>"});c=c.replace(/(\w+)\(/g,function(a){return"<span class='prop'>"+a.substr(0,a.length-1)+"</span>("});c=c.replace(/(\"(\\.|[^\"])*\")/g,function(a){return"<span class='str'>"+a+"</span>"});return c=c.replace(/(\/\/[a-zA-Z0-9\?\!\(\)_ ]*)/g,function(a){return"<span class='cmnt'>"+
a+"</span>"})}
(function(){function c(a,b){b=b||{};var c=document.createElement("div");c.className="litegui searchbox";c.innerHTML="<input value='"+a+"' placeholder='"+(null!=b.placeholder?b.placeholder:"Search")+"'/>";this.input=c.querySelector("input");this.root=c;var d=this;$(this.input).change(function(a){a=a.target.value;b.callback&&b.callback.call(d,a)})}function b(a,b){b=b||{};var c=document.createElement("div");c.className="litearea";a&&(c.id=a);this.root=c;this.root.litearea=this;var d=b.width||"100%",
f=b.height||"100%";0>d&&(d="calc( 100% - "+Math.abs(d)+"px)");0>f&&(f="calc( 100% - "+Math.abs(f)+"px)");c.style.width=d;c.style.height=f;this.options=b;var h=this;window.addEventListener("resize",function(a){h.resize(a)});this._computed_size=[$(this.root).width(),$(this.root).height()];c=document.createElement("div");b.content_id&&(c.id=b.content_id);c.className="liteareacontent";c.style.width="100%";c.style.height="100%";this.root.appendChild(c);this.content=c;this.split_direction="none";this.sections=
[];b.autoresize&&$(LiteGUI).bind("resized",function(){h.resize()})}LiteGUI.Button=function(a,b){b=b||{};"function"===typeof b&&(b={callback:b});var c=this,d=document.createElement("div");d.className="litegui button";this.root=d;var f=document.createElement("button");this.content=f;d.appendChild(f);f.innerHTML=a;f.addEventListener("click",function(a){c.click()});this.click=function(){b.callback&&b.callback.call(c)}};c.prototype.setValue=function(a){$(this.input).val(a).change()};c.prototype.getValue=
function(){return $(this.input).val()};LiteGUI.SearchBox=c;b.splitbar_size=4;b.prototype.getSection=function(a){a=a||0;return this.sections.length>a?this.sections[a]:null};b.prototype.resize=function(a){var b=[$(this.root).width(),$(this.root).height()];a&&this._computed_size&&b[0]==this._computed_size[0]&&b[1]==this._computed_size[1]||this.sendResizeEvent(a)};b.prototype.adjustHeight=function(){if(this.root.parentNode){var a=this.root.getClientRects()[0].top;this.root.style.height="calc( 100% - "+
a+"px )"}else console.error("Cannot adjust height of LiteGUI.Area without parent")};b.prototype.sendResizeEvent=function(a){if(this.sections.length)for(var b in this.sections)this.sections[b].resize(a);else for(a=0;a<this.root.childNodes.length;a++)b=this.root.childNodes[a],b.litearea?b.litearea.resize():$(b).trigger("resize");if(this.onresize)this.onresize()};b.prototype.split=function(a,e,c){function d(a){var b=q.root.ownerDocument;b.addEventListener("mousemove",f);b.addEventListener("mouseup",
h);t[0]=a.pageX;t[1]=a.pageY;a.stopPropagation();a.preventDefault()}function f(b){"horizontal"==a?t[0]!=b.pageX&&q.moveSplit(t[0]-b.pageX):"vertical"==a&&t[1]!=b.pageY&&q.moveSplit(b.pageY-t[1]);t[0]=b.pageX;t[1]=b.pageY;b.stopPropagation();b.preventDefault();q.options.inmediateResize&&q.resize()}function h(a){a=q.root.ownerDocument;a.removeEventListener("mousemove",f);a.removeEventListener("mouseup",h);q.resize()}a=a||"vertical";if(this.sections.length)throw"cannot split twice";var l=new LiteGUI.Area(null,
{content_id:this.content.id});l.root.style.display="inline-block";var m=new LiteGUI.Area;m.root.style.display="inline-block";var p="",k=null,n=null;c&&(p=" - "+(b.splitbar_size+2)+"px",k=document.createElement("div"),k.className="litesplitbar "+a,"vertical"==a?k.style.height=b.splitbar_size+"px":k.style.width=b.splitbar_size+"px",this.splitbar=k,k.addEventListener("mousedown",d));e=e||["50%",null];"vertical"==a?(l.root.style.width="100%",m.root.style.width="100%",null==e[0]?(n=e[1],"number"==typeof n&&
(n=e[1]+"px"),l.root.style.height="-moz-calc( 100% - "+n+p+" )",l.root.style.height="-webkit-calc( 100% - "+n+p+" )",l.root.style.height="calc( 100% - "+n+p+" )",m.root.style.height=n,m.size=n,n=l):null==e[1]?(n=e[0],"number"==typeof n&&(n=e[0]+"px"),l.root.style.height=n,l.size=n,m.root.style.height="-moz-calc( 100% - "+n+p+" )",m.root.style.height="-webkit-calc( 100% - "+n+p+" )",m.root.style.height="calc( 100% - "+n+p+" )",n=m):(p=e[0],"number"==typeof p&&(p=e[0]+"px"),c=e[1],"number"==typeof c&&
(c=e[1]+"px"),l.root.style.height=p,l.size=p,m.root.style.height=c,m.size=c)):(l.root.style.height="100%",m.root.style.height="100%",null==e[0]?(n=e[1],"number"==typeof n&&(n=e[1]+"px"),l.root.style.width="-moz-calc( 100% - "+n+p+" )",l.root.style.width="-webkit-calc( 100% - "+n+p+" )",l.root.style.width="calc( 100% - "+n+p+" )",m.root.style.width=n,m.size=e[1],n=l):null==e[1]?(n=e[0],"number"==typeof n&&(n=e[0]+"px"),l.root.style.width=n,l.size=n,m.root.style.width="-moz-calc( 100% - "+n+p+" )",
m.root.style.width="-webkit-calc( 100% - "+n+p+" )",m.root.style.width="calc( 100% - "+n+p+" )",n=m):(p=e[0],"number"==typeof p&&(p=e[0]+"px"),c=e[1],"number"==typeof c&&(c=e[1]+"px"),l.root.style.width=p,l.size=p,m.root.style.width=c,m.size=c));l.root.removeChild(l.content);l.root.appendChild(this.content);l.content=this.content;this.root.appendChild(l.root);k&&this.root.appendChild(k);this.root.appendChild(m.root);this.sections=[l,m];this.dynamic_section=n;this.direction=a;var q=this,t=[0,0]};b.prototype.hide=
function(){this.root.style.display="none"};b.prototype.show=function(){this.root.style.display="block"};b.prototype.showSection=function(a){var b=this.sections[a],c=0,c="horizontal"==this.direction?b.root.style.width:b.root.style.height;-1!=c.indexOf("calc")&&(c="50%");for(var d in this.sections)b=this.sections[d],d==a?b.root.style.display="inline-block":"horizontal"==this.direction?b.root.style.width="calc( 100% - "+c+" - 5px)":b.root.style.height="calc( 100% - "+c+" - 5px)";this.splitbar&&(this.splitbar.style.display=
"inline-block");this.sendResizeEvent()};b.prototype.hideSection=function(a){for(var b in this.sections){var c=this.sections[b];b==a?c.root.style.display="none":"horizontal"==this.direction?c.root.style.width="100%":c.root.style.height="100%"}this.splitbar&&(this.splitbar.style.display="none");this.sendResizeEvent()};b.prototype.moveSplit=function(a){if(this.sections){var e=this.sections[0],c=this.sections[1],d=" - "+b.splitbar_size+"px";"horizontal"==this.direction?this.dynamic_section==e?(a=$(c.root).width()+
a+"px",e.root.style.width="-moz-calc( 100% - "+a+d+" )",e.root.style.width="-webkit-calc( 100% - "+a+d+" )",e.root.style.width="calc( 100% - "+a+d+" )",c.root.style.width=a):(a=$(e.root).width()-a+"px",e.root.style.width=a,c.root.style.width="-moz-calc( 100% - "+a+d+" )",c.root.style.width="-webkit-calc( 100% - "+a+d+" )",c.root.style.width="calc( 100% - "+a+d+" )"):"vertical"==this.direction&&(this.dynamic_section==e?(a=$(c.root).height()-a+"px",e.root.style.height="-moz-calc( 100% - "+a+d+" )",
e.root.style.height="-webkit-calc( 100% - "+a+d+" )",e.root.style.height="calc( 100% - "+a+d+" )",c.root.style.height=a):(a=$(e.root).height()+a+"px",e.root.style.height=a,c.root.style.height="-moz-calc( 100% - "+a+d+" )",c.root.style.height="-webkit-calc( 100% - "+a+d+" )",c.root.style.height="calc( 100% - "+a+d+" )"))}};b.prototype.setAreaSize=function(a,e){var c=this.sections[1],d=" - "+b.splitbar_size+"px";c.root.style.width="-moz-calc( 100% - "+e+d+" )";c.root.style.width="-webkit-calc( 100% - "+
e+d+" )";c.root.style.width="calc( 100% - "+e+d+" )"};b.prototype.merge=function(a){if(0==this.sections.length)throw"not splitted";a=this.sections[a||0];this.root.appendChild(a.content);this.content=a.content;this.root.removeChild(this.sections[0].root);this.root.removeChild(this.sections[1].root);this.sections=[];this._computed_size=null;this.resize()};b.prototype.add=function(a){if("string"==typeof a){var b=document.createElement("div");b.innerHTML=a;a=b}this.content.appendChild(a.root||a)};b.prototype.query=
function(a){return this.root.querySelector(a)};LiteGUI.Area=b;LiteGUI.Split=function(a,b,c){c=c||{};var d=document.createElement("div");this.root=d;d.id=a;d.className="litesplit "+(c.vertical?"vsplit":"hsplit");this.sections=[];for(var f in b)a=document.createElement("div"),a.className="split-section split"+f,"number"==typeof b[f]?c.vertical?a.style.height=b[f].toFixed(1)+"%":a.style.width=b[f].toFixed(1)+"%":"string"==typeof b[f]?c.vertical?a.style.height=b[f]:a.style.width=b[f]:(b[f].id&&(a.id=
b[f].id),c.vertical?a.style.height="Number"==typeof b[f].height?b[f].height.toFixed(1)+"%":b[f].height:a.style.width="Number"==typeof b[f].width?b[f].width.toFixed(1)+"%":b[f].width),a.add=function(a){this.appendChild(a.root||a)},this.sections.push(a),d.appendChild(a);c.parent&&(c.parent.root?c.parent.root.appendChild(d):c.parent.appendChild(d));this.getSection=function(a){return this.sections[a]}};LiteGUI.ContextualMenu=function(a,b){function c(a){a=this.value;b.callback&&b.callback.call(d,a,b);
f.parentNode&&f.parentNode.removeChild(f)}this.options=b=b||{};var d=this,f=document.createElement("div");f.className="litecontextualmenu litemenubar-panel";f.style.minWidth=100;f.style.minHeight=100;f.style.pointerEvents="none";setTimeout(function(){f.style.pointerEvents="auto"},100);this.root=f;for(var h in a){var l=document.createElement("div");l.className="litemenu-entry submenu";var m=a.constructor==Array?a[h]:h,p=a[h];l.innerHTML=p&&p.title?p.title:m;l.value=p;"function"==typeof p?(l.dataset.value=
m,l.onclick_callback=p):"object"==typeof p?p.callback&&l.addEventListener("click",function(a){this.value.callback.apply(this,this.value)}):l.dataset.value=p;f.appendChild(l);l.addEventListener("click",c)}f.addEventListener("mouseleave",function(a){this.parentNode&&this.parentNode.removeChild(this)});document.body.appendChild(f);h=b.left||0;l=b.top||0;b.event&&(h=b.event.pageX-10,l=b.event.pageY-10,m=document.body.getClientRects()[0],h>m.width-$(f).width()-10&&(h=m.width-$(f).width()-10),l>m.height-
$(f).height()-10&&(l=m.height-$(f).height()-10));f.style.left=h+"px";f.style.top=l+"px"};LiteGUI.Checkbox=function(a,b){var c=this.root=document.createElement("span");c.className="litecheckbox inputfield";c.dataset.value=a;var d=this.element=document.createElement("span");d.className="fixed flag checkbox "+(a?"on":"off");c.appendChild(d);c.addEventListener("click",function(a){this.setValue("true"!=this.root.dataset.value);a.preventDefault();a.stopPropagation()}.bind(this));this.setValue=function(a){this.root.dataset.value!=
a.toString()&&((this.root.dataset.value=a)?(this.element.classList.remove("off"),this.element.classList.add("on")):(this.element.classList.remove("on"),this.element.classList.add("off")),b&&b(a))};this.getValue=function(){return"true"==this.root.dataset.value}};LiteGUI.createLitebox=function(a,b){var c=document.createElement("span");c.className="listbox "+(a?"listopen":"listclosed");c.innerHTML=a?"&#9660;":"&#9658;";c.dataset.value=a?"open":"closed";c.addEventListener("click",function(a){console.log("CLICK");
a.target.setValue("open"==this.dataset.value?!1:!0);this.stopPropagation&&a.stopPropagation()});c.on_change_callback=b;c.setEmpty=function(a){a?this.classList.add("empty"):this.classList.remove("empty")};c.setValue=function(a){this.dataset.value!=(a?"open":"closed")&&(a?(this.dataset.value="open",this.innerHTML="&#9660;",this.classList.add("listopen"),this.classList.remove("listclosed")):(this.dataset.value="closed",this.innerHTML="&#9658;",this.classList.remove("listopen"),this.classList.add("listclosed")),
b&&b(this.dataset.value))};c.getValue=function(){return this.dataset.value};return c};LiteGUI.List=function(a,b,c){c=c||{};var d=document.createElement("ul");this.root=d;d.id=a;d.className="litelist";this.items=[];var f=this;this.callback=c.callback;for(var h in b){a=document.createElement("li");a.className="list-item";a.data=b[h];var l="";"string"==typeof b[h]?l=b[h]+"<span class='arrow'></span>":(l=(b[h].name||b[h].title||"")+"<span class='arrow'></span>",b[h].id&&(a.id=b[h].id));a.innerHTML=l;
d.appendChild(a)}$(d).find(".list-item").click(function(){$(d).find(".list-item.selected").removeClass("selected");$(this).addClass("selected");$(f.root).trigger("wchanged",this);f.callback&&f.callback(this.data)});c.parent&&(c.parent.root?$(c.parent.root).append(d):$(c.parent).append(d))};LiteGUI.Slider=function(a,b){function c(a){var d=h.getClientRects()[0].width,g=b.min||0;l.setValue(a/d*((b.max||1)-g)+g)}function d(a){var b=h.getClientRects()[0];c((void 0===a.x?a.pageX:a.x)-b.left);a.preventDefault();
return!1}function f(a){document.removeEventListener("mousemove",d);document.removeEventListener("mouseup",f);a.preventDefault();return!1}b=b||{};var h=document.createElement("canvas");h.className="slider "+(b.extraclass?b.extraclass:"");h.width=100;h.height=1;h.style.position="relative";h.style.width="calc( 100% - 2em )";h.style.height="1.2em";this.root=h;var l=this;this.value=a;this.setValue=function(a){var c=h.getContext("2d"),d=b.min||0,g=b.max||1;a<d?a=d:a>g&&(a=g);d=(a-d)/(g-d);c.clearRect(0,
0,h.width,h.height);c.fillStyle="#999";c.fillRect(0,0,h.width*d,h.height);c.fillStyle="#DA2";c.fillRect(h.width*d-1,0,2,h.height);a!=this.value&&(this.value=a,$(this.root).trigger("change",a))};h.addEventListener("mousedown",function(a){var b;a.offsetX?b=a.offsetX:a.layerX&&(b=a.layerX);c(b);document.addEventListener("mousemove",d);document.addEventListener("mouseup",f)});this.setValue(a)};LiteGUI.LineEditor=function(a,b){function c(a){return[n.width*((k.xrange[1]-k.xrange[0])*a[0]+k.xrange[0]),n.height*
((k.yrange[1]-k.yrange[0])*a[1]+k.yrange[0])]}function d(a){return[(a[0]/n.width-k.xrange[0])/(k.xrange[1]-k.xrange[0]),(a[1]/n.height-k.yrange[0])/(k.yrange[1]-k.yrange[0])]}function f(a){var b=n.getBoundingClientRect(),c=a.clientX-b.left,e=a.clientY-b.top;0>c?c=0:c>n.width&&(c=n.width);0>e?e=0:e>n.height&&(e=n.height);if(-1!=q&&m([a.clientX-b.left,a.clientY-b.top],[c,e])>0.5*n.height)k.value.splice(q,1),h(a);else{b=d([-(t[0]-c),t[1]-e]);if(-1!=q){var g=k.xrange[0],f=k.xrange[1];k.no_trespassing&&
(0<q&&(g=k.value[q-1][0]),q<k.value.length-1&&(f=k.value[q+1][0]));var s=k.value[q];s[0]+=b[0];s[1]+=b[1];s[0]<g?s[0]=g:s[0]>f&&(s[0]=f);s[1]<k.yrange[0]?s[1]=k.yrange[0]:s[1]>k.yrange[1]&&(s[1]=k.yrange[1])}p();k.redraw();t[0]=c;t[1]=e;l();a.preventDefault();a.stopPropagation()}}function h(a){q=-1;k.redraw();$(document).unbind("mousemove",f);$(document).unbind("mouseup",h);l();a.preventDefault();a.stopPropagation()}function l(){b.callback?b.callback.call(k,k.value):$(k).change()}function m(a,b){return Math.sqrt(Math.pow(b[0]-
a[0],2)+Math.pow(b[1]-a[1],2))}function p(){var a=null;-1!=q&&(a=k.value[q]);k.value.sort(function(a,b){return a[0]>b[0]});a&&(q=k.value.indexOf(a))}b=b||{};var k=document.createElement("div");k.className="curve "+(b.extraclass?b.extraclass:"");k.style.minHeight="50px";k.style.width=b.width||"100%";k.bgcolor=b.bgcolor||"#222";k.pointscolor=b.pointscolor||"#5AF";k.linecolor=b.linecolor||"#444";k.value=a||[];k.xrange=b.xrange||[0,1];k.yrange=b.yrange||[0,1];k.defaulty=null!=b.defaulty?b.defaulty:0.5;
k.no_trespassing=b.no_trespassing||!1;k.show_samples=b.show_samples||0;k.options=b;var n=document.createElement("canvas");n.width=b.width||200;n.height=b.height||50;k.appendChild(n);k.canvas=n;$(n).bind("mousedown",function(a){$(document).bind("mousemove",f);$(document).bind("mouseup",h);for(var b=n.getBoundingClientRect(),e=a.clientX-b.left,b=a.clientY-b.top,l=n.height-b,v=1E5,w=-1,s=0;s<k.value.length;s++){var u=c(k.value[s]),u=m([e,l],u);u<v&&8>u&&(v=u,w=s)}q=w;-1==q&&(l=d([e,n.height-b]),k.value.push(l),
p(),q=k.value.indexOf(l));t=[e,b];k.redraw();a.preventDefault();a.stopPropagation()});$(k).resize(function(a){n.width=$(this).width();n.height=$(this).height();k.redraw()});k.getValueAt=function(a){if(a<k.xrange[0]||a>k.xrange[1])return k.defaulty;for(var b=[k.xrange[0],k.defaulty],c=0,c=0;c<k.value.length;c+=1){var e=k.value[c];if(a==e[0])return e[1];if(a<e[0])return c=(a-b[0])/(e[0]-b[0]),b[1]*(1-c)+e[1]*c;b=e}e=[k.xrange[1],k.defaulty];c=(a-b[0])/(e[0]-b[0]);return b[1]*(1-c)+e[1]*c};k.resample=
function(a){var b=[];a=(k.xrange[1]-k.xrange[0])/a;for(var c=k.xrange[0];c<=k.xrange[1];c+=a)b.push(k.getValueAt(c));return b};k.addValue=function(a){for(var b=0;b<k.value;b++)if(!(k.value[b][0]<a[0])){k.value.splice(b,0,a);redraw();return}k.value.push(a);redraw()};var q=-1;k.redraw=function(){var a=n.getContext("2d");a.setTransform(1,0,0,1,0,0);a.translate(0,n.height);a.scale(1,-1);a.fillStyle=k.bgcolor;a.fillRect(0,0,n.width,n.height);a.strokeStyle=k.linecolor;a.beginPath();var b=c([k.xrange[0],
k.defaulty]);a.moveTo(b[0],b[1]);for(var e in k.value)b=k.value[e],b=c(b),a.lineTo(b[0],b[1]);b=c([k.xrange[1],k.defaulty]);a.lineTo(b[0],b[1]);a.stroke();for(e=0;e<k.value.length;e+=1)b=k.value[e],b=c(b),a.fillStyle=q==e?"white":k.pointscolor,a.beginPath(),a.arc(b[0],b[1],q==e?4:2,0,2*Math.PI),a.fill();if(k.show_samples){var d=k.resample(k.show_samples);a.fillStyle="#888";for(e=0;e<d.length;e+=1)b=[(k.xrange[1]-k.xrange[0])/k.show_samples*e+k.xrange[0],d[e]],b=c(b),a.beginPath(),a.arc(b[0],b[1],
2,0,2*Math.PI),a.fill()}};var t=[0,0];k.redraw();return k}})();
(function(){function c(b){this.menu=[];this.panels=[];this.root=document.createElement("div");this.root.id=b;this.root.className="litemenubar";this.content=document.createElement("ul");this.root.appendChild(this.content);this.is_open=!1}c.closing_time=500;c.prototype.clear=function(){$(this.content).empty();this.menu=[];this.panels=[]};c.prototype.attachToPanel=function(b){$(b.content).prepend(this.root)};c.prototype.add=function(b,a){a=a||{};for(var c=this.menu.length,g=b.split("/"),d=0,f=0,h=this.menu;h;){if(5<
d)throw"Error: Menubar too deep";if(h.length==f){f={children:[]};d==g.length-1&&(f.data=a);f.disable=function(){this.data&&(this.data.disabled=!0)};f.enable=function(){this.data&&delete this.data.disabled};f.name=g[d];h.push(f);d++;if(d==g.length)break;f.children=[];h=f.children;f=0}else{if(h[f]&&g[d]==h[f].name)if(d<g.length-1){h=h[f].children;f=0;d++;continue}else{console.warn("Warning: Adding menu that already exists: "+b);break}f++}}c!=this.menu.length&&this.updateMenu()};c.prototype.separator=
function(b,a){var c=this.findMenu(b);c&&c.push({separator:!0,order:a||10})};c.prototype.findMenu=function(b){b=b.split("/");for(var a=0,c=0,g=this.menu;g;){if(a==b.length)return g;if(g.length<=c)break;if("*"==b[a])return g[c].children;if(b[a]==g[c].name)if(a<b.length){g=g[c].children;c=0;a++;continue}else return g[c];c++}return null};c.prototype.updateMenu=function(){var b=this;$(this.content).empty();for(var a in this.menu){var c=document.createElement("li");c.innerHTML="<span class='icon'></span><span class='name'>"+
this.menu[a].name+"</span>";this.content.appendChild(c);c.data=this.menu[a];this.menu[a].element=c;$(c).bind("click",function(a){var c=this.data;c.data&&c.data.callback&&"function"==typeof c.data.callback&&c.data.callback(c.data);b.is_open?(b.is_open=!1,b.hidePanels()):(b.is_open=!0,b.showMenu(c,a,this))});$(c).bind("mouseover",function(a){b.hidePanels();b.is_open&&b.showMenu(this.data,a,this)})}};c.prototype.hidePanels=function(){if(this.panels.length){for(var b in this.panels)$(this.panels[b]).remove();
this.panels=[]}};c.prototype.showMenu=function(b,a,c,g){g||this.hidePanels();if(b.children&&b.children.length){var d=this;d.closing_by_leave&&clearInterval(d.closing_by_leave);var f=document.createElement("div");f.className="litemenubar-panel";var h=[],l;for(l in b.children)h.push(b.children[l]);h.sort(function(a,b){var c=10,e=10;a&&a.data&&null!=a.data.order&&(c=a.data.order);a&&a.separator&&null!=a.order&&(c=a.order);b&&b.data&&null!=b.data.order&&(e=b.data.order);b&&b.separator&&null!=b.order&&
(e=b.order);return c-e});for(l in h){b=document.createElement("p");var m=h[l];b.className="litemenu-entry "+(b.children?" submenu":"");b.innerHTML=m&&m.name?"<span class='icon'></span><span class='name'>"+m.name+(m.children&&m.children.length?"<span class='more'>+</span>":"")+"</span>":"<span class='separator'></span>";b.data=m;if(b.data.data){m=b.data.data;if("checkbox"==m.type&&m.instance&&m.property&&!0==m.instance[m.property]||!0==m.checkbox||m.instance&&m.property&&m.hasOwnProperty("value")&&
m.instance[m.property]==m.value||"function"==typeof m.isChecked&&m.isChecked.call(m.instance,m))b.className+=" checked";m.disabled&&(b.className+=" disabled")}$(b).bind("click",function(){var b=this.data;if(b.data){if(b.data.disabled)return;b.data.instance&&b.data.property&&("checkbox"==b.data.type?(b.data.instance[b.data.property]=!b.data.instance[b.data.property],b.data.instance[b.data.property]?$(this).addClass("checked"):$(this).removeClass("checked")):b.data.hasOwnProperty("value")&&(b.data.instance[b.data.property]=
b.data.value));null!=b.data.checkbox&&(b.data.checkbox=!b.data.checkbox,b.data.checkbox?$(this).addClass("checked"):$(this).removeClass("checked"));b.data.callback&&"function"==typeof b.data.callback&&b.data.callback(b.data)}b.children&&b.children.length?d.showMenu(b,a,this,!0):(d.is_open=!1,d.hidePanels())});$(f).append(b)}$(f).bind("mouseleave",function(a){d.closing_by_leave&&clearInterval(d.closing_by_leave);d.closing_by_leave=setTimeout(function(){d.is_open=!1;d.hidePanels()},LiteGUI.Menubar.closing_time)});
$(f).bind("mouseenter",function(a){d.closing_by_leave&&clearInterval(d.closing_by_leave);d.closing_by_leave=null});c=$(c);f.style.left=c.offset().left+(g?200:0)+"px";f.style.top=c.offset().top+c.height()+(g?-20:2)+"px";this.panels.push(f);$(document.body).append(f);$(f).hide().show()}};LiteGUI.Menubar=c})();
(function(){function c(b,a){this.options=a=a||{};var c=this.mode=a.mode||"horizontal",g=document.createElement("DIV");b&&(g.id=b);g.data=this;g.className="litetabs "+c;this.root=g;this.root.tabs=this;this.current_tab=null;"horizontal"==c?a.size&&(this.root.style.height="full"==a.size?"100%":a.size):"vertical"==c&&a.size&&(this.root.style.width="full"==a.size?"100%":a.size);g=document.createElement("UL");g.className="wtabcontainer";"vertical"==c?g.style.width=LiteGUI.Tabs.tabs_width+"px":g.style.height=
LiteGUI.Tabs.tabs_height+"px";this.list=g;this.root.appendChild(this.list);this.tabs={};this.selected=null;this.onchange=a.callback;a.parent&&this.appendTo(a.parent)}c.tabs_width=64;c.tabs_height=26;c.prototype.show=function(){this.root.style.display="block"};c.prototype.hide=function(){this.root.style.display="none"};c.prototype.getCurrentTab=function(){return this.current_tab?this.tabs[this.current_tab[0]]:null};c.prototype.getCurrentTabId=function(){return this.current_tab[0]};c.prototype.getPreviousTab=
function(){return this.previous_tab?this.tabs[this.previous_tab[0]]:null};c.prototype.appendTo=function(b,a){a?$(b).prepend(this.root):$(b).append(this.root)};c.prototype.getTab=function(b){return this.tabs[b]};c.prototype.getTabContent=function(b){if(b=this.tabs[b])return b.content};c.prototype.getTabIndex=function(b){b=this.tabs[b];if(!b)return-1;for(var a=0;a<this.list.childNodes.length;a++)if(this.list.childNodes[a]==b.tab)return a;return-1};c.prototype.addTab=function(b,a,e){a=a||{};"function"==
typeof a&&(a={callback:a});var g=this;e=document.createElement("LI");var d=b.replace(/ /gi,"_");e.className="wtab wtab-"+d;e.dataset.id=b;e.innerHTML="<span class='tabtitle'>"+(a.title||b)+"</span>";a.bigicon&&(e.innerHTML="<img class='tabbigicon' src='"+a.bigicon+"'/>"+e.innerHTML);a.closable&&(e.innerHTML+="<span class='tabclose'>X</span>",e.querySelector("span.tabclose").addEventListener("click",function(a){g.removeTab(b);a.preventDefault();a.stopPropagation()},!0));a.index&&-1!=a.index?this.list.insertBefore(e,
this.list.childNodes[a.index]):this.list.appendChild(e);var f=document.createElement("div");a.id&&(f.id=a.id);f.className="wtabcontent wtabcontent-"+d+" "+(a.className||"");f.dataset.id=b;f.style.display="none";"horizontal"==this.mode?a.size&&(f.style.overflow="auto","full"==a.size?(f.style.height="calc( 100% - "+LiteGUI.Tabs.tabs_height+"px )",f.style.height="-moz-calc( 100% - "+LiteGUI.Tabs.tabs_height+"px )",f.style.height="-webkit-calc( 100% - "+LiteGUI.Tabs.tabs_height+"px )"):f.style.height=
a.size):"vertical"==this.mode&&a.size&&(f.style.overflow="auto","full"==a.size?(f.style.width="calc( 100% - "+LiteGUI.Tabs.tabs_width+"px )",f.style.width="-moz-calc( 100% - "+LiteGUI.Tabs.tabs_width+"px )",f.style.width="-webkit-calc( 100% - "+LiteGUI.Tabs.tabs_width+"px )"):f.style.width=a.size);a.content&&("string"==typeof a.content?f.innerHTML=a.content:f.appendChild(a.content));this.root.appendChild(f);e.addEventListener("click",c.prototype.onTabClicked);e.options=a;e.tabs=this;this.list.appendChild(e);
e={id:b,tab:e,content:f,add:function(a){this.content.appendChild(a.root||a)}};a.onclose&&(e.onclose=a.onclose);this.tabs[b]=e;!0!=a.selected&&null!=this.selected||this.selectTab(b,a.skip_callbacks);return e};c.prototype.onTabClicked=function(b){if(!this.classList.contains("selected")&&this.parentNode){var a=this.options,c=this.parentNode.parentNode.tabs;if(!c)throw"tabs not found";if(!a.callback_canopen||!1!=a.callback_canopen()){var g=this.dataset.id,d=null,f;for(f in c.tabs){var h=c.tabs[f];f==
g?(h.selected=!0,h.content.style.display=null,d=h.content):(delete h.selected,h.content.style.display="none")}$(c.list).find("li.wtab").removeClass("selected");this.classList.add("selected");c.current_tab&&c.current_tab[0]!=g&&c.current_tab[2]&&c.current_tab[2].callback_leave&&c.current_tab[2].callback_leave(c.current_tab[0],c.current_tab[1],c.current_tab[2]);c.previous_tab=c.current_tab;c.current_tab=[g,d,a];if(b&&(a.callback&&a.callback(g,d),$(c).trigger("wchange",[g,d]),c.onchange))c.onchange(g,
d);c.selected=g}}};c.prototype.selectTab=function(b,a){if(b){"string"!=typeof b&&(b=b.id);for(var c=this.list.querySelectorAll("li.wtab"),g=0;g<c.length;g++)if(b==c[g].dataset.id){this.onTabClicked.call(c[g],!a);break}}};c.prototype.setTabVisibility=function(b,a){var c=this.tabs[b];c&&(c.tab.style.display=a?"none":null,c.content.style.display=a?"none":null)};c.prototype.removeTab=function(b){var a=this.tabs[b];if(a){if(a.onclose)a.onclose(a);a.tab.parentNode.removeChild(a.tab);a.content.parentNode.removeChild(a.content);
delete this.tabs[b]}};c.prototype.removeAllTabs=function(){var b=[],a;for(a in this.tabs)b.push(this.tabs[a]);for(a in b){var c=b[a];c.tab.parentNode.removeChild(c.tab);c.content.parentNode.removeChild(c.content);delete this.tabs[c.id]}this.tabs={}};c.prototype.hideTab=function(b){this.setTabVisibility(b,!1)};c.prototype.showTab=function(b){this.setTabVisibility(b,!0)};c.prototype.transferTab=function(b,a,c){var g=this.tabs[b];if(g){a.tabs[b]=g;void 0!==c?a.list.insertBefore(g.tab,a.list.childNodes[c]):
a.list.appendChild(g.tab);a.root.appendChild(g.content);delete this.tabs[b];c=null;for(var d in this.tabs){c=d;break}c&&this.selectTab(c);g.tab.classList.remove("selected");a.selectTab(b)}};c.prototype.detachTab=function(b,a,c){if(this.tabs[b]){var g=this.getTabIndex(b),d=window.open("","","width=800, height=600, location=no, status=no, menubar=no, titlebar=no, fullscreen=yes");d.document.write("<head><title>"+b+"</title>");for(var f=document.querySelectorAll("link[rel='stylesheet'],style"),h=0;h<
f.length;h++)d.document.write(f[h].outerHTML);d.document.write("</head><body></body>");d.document.close();var l=this,m=new LiteGUI.Tabs(null,this.options);d.tabs=m;d.onbeforeunload=function(){m.transferTab(b,l,g);c&&c()};m.list.style.height="20px";d.document.body.appendChild(m.root);l.transferTab(b,m);m.tabs[b].tab.classList.add("selected");a&&a();return d}};LiteGUI.Tabs=c})();
(function(){LiteGUI.Dragger=function(c,b){function a(a){var c=[a.screenX-m.data[0],m.data[1]-a.screenY];m.data=[a.screenX,a.screenY];g(c[b.horizontal?0:1],a);a.stopPropagation();a.preventDefault();return!1}function e(b){$(d).trigger("stop_dragging");$(document).unbind("mousemove",a);$(document).unbind("mouseup",e);$(m).trigger("blur");b.stopPropagation();b.preventDefault();return!1}function g(a,c){var e=b.step?b.step:1;c&&c.shiftKey?e*=10:c&&c.ctrlKey&&(e*=0.1);e=parseFloat(l.value)+a*e;null!=b.max&&
e>b.max&&(e=b.max);null!=b.min&&e<b.min&&(e=b.min);l.value=b.precision?e.toFixed(b.precision):(1E3*e<<0)/1E3;b.units&&(l.value+=b.units);$(l).change()}b=b||{};var d=document.createElement("div");d.className="dragger "+(b.extraclass?b.extraclass:"");this.root=d;var f=document.createElement("span");f.className="inputfield "+(b.extraclass?b.extraclass:"")+(b.full?" full":"");b.disabled&&(f.className+=" disabled");d.appendChild(f);var h=b.dragger_class||"full",l=document.createElement("input");l.className=
"text number "+(h?h:"");l.value=c+(b.units?b.units:"");l.tabIndex=b.tab_index;this.input=l;d.input=l;b.disabled&&(l.disabled=!0);b.tab_index&&(l.tabIndex=b.tab_index);f.appendChild(l);this.setValue=function(a){$(l).val(a).trigger("change")};$(l).bind("keydown",function(a){if(38==a.keyCode)g(1,a);else if(40==a.keyCode)g(-1,a);else return;a.stopPropagation();a.preventDefault();return!0});var m=document.createElement("div");m.className="drag_widget";b.disabled&&(m.className+=" disabled");f.appendChild(m);
d.dragger=m;$(m).bind("mousedown",function(c){$(document).unbind("mousemove",a);$(document).unbind("mouseup",e);b.disabled||($(document).bind("mousemove",a),$(document).bind("mouseup",e),m.data=[c.screenX,c.screenY],$(d).trigger("start_dragging"));c.stopPropagation();c.preventDefault()})}})();
(function(){function c(b,a,c){var g=document.createElement("div");this.root=g;b&&(g.id=b);g.className="litetree";this.tree=a;var d=this;this.options=c=c||{allow_rename:!0,drag:!0,allow_multiselection:!1};g.addEventListener("click",function(a){if(a.srcElement==d.root&&d.onBackgroundClicked)d.onBackgroundClicked(a,d)});b=this.createAndInsert(a,c,null);b.className+=" root_item";this.root_item=b}c.PADDING=20;c.prototype.updateTree=function(b){this.root.innerHTML="";b=this.createAndInsert(b,this.options,
null);b.className+=" root_item";this.root_item=b};c.prototype.insertItem=function(b,a,c,g){if(!a){var d=this.root.childNodes[0];d&&(a=d.dataset.item_id)}b=this.createAndInsert(b,g,a,c);a&&this._updateListBox(this._findElement(a));return b};c.prototype.createAndInsert=function(b,a,c,g){var d=-1;c?d=this._findElementIndex(c):void 0===c&&(d=0);var f=null,f=0;-1!=d&&(f=this.root.childNodes[d],f=parseInt(f.dataset.level)+1);f=this.createTreeItem(b,a,f);f.parent_id=c;-1==d?this.root.appendChild(f):this._insertInside(f,
d,g);if(b.children)for(c=0;c<b.children.length;++c)this.createAndInsert(b.children[c],a,b.id);this._updateListBox(f);return f};c.prototype._insertInside=function(b,a,e){var g=parseInt(this.root.childNodes[a].dataset.level)+1;b.style.paddingLeft=g*c.PADDING+"px";b.dataset.level=g;for(a+=1;a<this.root.childNodes.length;++a){var d=this.root.childNodes[a];if(d.classList&&d.classList.contains("ltreeitem")){var f=parseInt(d.dataset.level);if(f==g&&e)e--;else if(f<g||0===e&&f===g){this.root.insertBefore(b,
d);return}}}this.root.appendChild(b)};c.prototype._findElement=function(b){for(var a=0;a<this.root.childNodes.length;++a){var c=this.root.childNodes[a];if(c.classList&&c.classList.contains("ltreeitem")&&c.classList.contains("ltreeitem-"+b))return c}return null};c.prototype._findElementIndex=function(b){for(var a=0;a<this.root.childNodes.length;++a){var c=this.root.childNodes[a];if(c.classList&&c.classList.contains("ltreeitem"))if("string"===typeof b){if(c.dataset.item_id===b)return a}else if(c===
b)return a}return-1};c.prototype._findChildElements=function(b){var a=this._findElementIndex(b);if(-1!=a){b=parseInt(this.root.childNodes[a].dataset.level);for(var c=[],a=a+1;a<this.root.childNodes.length;++a){var g=this.root.childNodes[a];if(g.classList&&g.classList.contains("ltreeitem")){if(parseInt(g.dataset.level)<=b)break;c.push(g)}}return c}};c.prototype.createTreeItem=function(b,a,c){a=document.createElement("li");a.className="ltreeitem";if(b.id){var g=b.id.replace(/\s/g,"_");a.className+=
" ltreeitem-"+g;a.dataset.item_id=b.id}b.DOM=a;a.data=b;void 0!==c&&(a.dataset.level=c);var d=document.createElement("div");d.className="ltreeitemtitle";b.className&&(d.className+=" "+b.className);d.innerHTML="<span class='precontent'></span><span class='incontent'>"+(b.content||b.id||"")+"</span><span class='postcontent'></span>";if(b.dataset)for(var f in b.dataset)a.dataset[f]=b.dataset[f];a.appendChild(d);a.title_element=d;a.addEventListener("click",function(a){a.preventDefault();a.stopPropagation();
if(!this.title_element._editing)if(a.shiftKey&&h.options.allow_multiselection)if(h.isNodeSelected(this))this.title_element.classList.remove("selected"),LiteGUI.trigger(h.root,"item_remove_from_selection",{item:this,data:this.data});else{if(h.markAsSelected(this,!0),LiteGUI.trigger(h.root,"item_add_to_selection",{item:this,data:this.data}),a=!1,b.callback&&(a=b.callback.call(h,this)),!a&&h.onItemAddToSelection)h.onItemAddToSelection(this.data,this)}else if(h.markAsSelected(this),LiteGUI.trigger(h.root,
"item_selected",{item:this,data:this.data}),a=!1,b.callback&&(a=b.callback.call(h,this)),!a&&h.onItemSelected)h.onItemSelected(this.data,this)});a.addEventListener("dblclick",function(a){var b=this,c=b.title_element.querySelector(".incontent");LiteGUI.trigger(h.root,"item_dblclicked",b);if(!c._editing&&h.options.allow_rename){c._editing=!0;c._old_name=c.innerHTML;c.innerHTML="<input type='text' value='"+c.innerHTML+"' />";var e=c.querySelector("input");$(e).blur(function(a){var e=a.target.value;setTimeout(function(){c.innerHTML=
e},1);delete c._editing;LiteGUI.trigger(h.root,"item_renamed",{old_name:c._old_name,new_name:e,item:b,data:b.data});delete c._old_name});e.addEventListener("keydown",function(a){13==a.keyCode&&$(this).blur()});$(e).focus();a.preventDefault()}a.preventDefault();a.stopPropagation()});a.addEventListener("contextmenu",function(a){var b=this.parentNode.parentNode;if(h.onContextMenu&&(b={item:b,data:b.data},2==a.button&&h.onContextMenu))h.onContextMenu(a,b);a.preventDefault();return!1});var h=this;d.draggable=
!0;d.addEventListener("dragstart",function(a){a.dataTransfer.setData("item_id",this.parentNode.dataset.item_id)});d.addEventListener("dragenter",function(a){a.preventDefault();if(b.skipdrag)return!1;d.classList.add("dragover")});d.addEventListener("dragleave",function(a){a.preventDefault();d.classList.remove("dragover")});d.addEventListener("dragover",function(a){a.preventDefault()});d.addEventListener("drop",function(a){$(d).removeClass("dragover");a.preventDefault();if(b.skipdrag)return!1;var c=
a.dataTransfer.getData("item_id");c?(a=this.parentNode.dataset.item_id,(!h.onMoveItem||h.onMoveItem&&!1!=h.onMoveItem(h.getItem(c),h.getItem(a)))&&h.moveItem(c,a)&&LiteGUI.trigger(h.root,"item_moved",{item:h.getItem(c),parent_item:h.getItem(a)})):LiteGUI.trigger(h.root,"drop_on_item",{item:this,event:a})});return a};c.prototype.filterByName=function(b){for(var a=this.root.querySelectorAll(".ltreeitemtitle .incontent"),e=0;e<a.length;e++){var g=a[e];if(g){var d=g.innerHTML,g=g.parentNode;b&&-1==d.indexOf(b)?
(g.style.display="none",g.parentNode.style.paddingLeft=0):(g.style.display=null,g.parentNode.style.paddingLeft=parseInt(g.parentNode.dataset.level)*c.PADDING+"px")}}};c.prototype.getItem=function(b){if(!b)return null;if(b.classList)return b;for(var a=0;a<this.root.childNodes.length;++a){var c=this.root.childNodes[a];if(c.classList&&c.classList.contains("ltreeitem")&&c.dataset.item_id===b)return c}return null};c.prototype.expandItem=function(b){(b=this.getItem(b))&&b.listbox&&listbox.setValue(!0)};
c.prototype.contractItem=function(b){(b=this.getItem(b))&&b.listbox&&listbox.setValue(!1)};c.prototype.setSelectedItem=function(b){if(b){b=this.getItem(b);if(!b)return null;this.markAsSelected(b);return b}this.unmarkAllAsSelected()};c.prototype.addItemToSelection=function(b){if(b){b=this.getItem(b);if(!b)return null;this.markAsSelected(b,!0);return b}};c.prototype.removeItemFromSelection=function(b){if(b){b=this.getItem(b);if(!b)return null;b.title_element.classList.remove("selected")}};c.prototype.getSelectedItem=
function(){return this.root.querySelector(".ltreeitemtitle.selected")};c.prototype.getSelectedItems=function(){return this.root.querySelectorAll(".ltreeitemtitle.selected")};c.prototype.getItemNode=function(b){return this.root.querySelector(".ltreeitemtitle.selected")};c.prototype.isItemSelected=function(b){return(b=this.getItemNode(b))?this.isNodeSelected(b):!1};c.prototype.getChildren=function(b){return this._findChildElements(b)};c.prototype.getParent=function(b){return(b=this.getItem(b))?this.getItem(b.parent_id):
null};c.prototype.moveItem=function(b,a){if(b!==a){var c=this.getItem(b),g=this.getItem(a),d=this._findElementIndex(g),f=parseInt(g.dataset.level),h=this.getParent(c),d=parseInt(h.dataset.level),d=f-d;if(!g||!c)return!1;if(g!=h){c.parent_id=a;f=this.getChildren(c);f.unshift(c);for(c=0;c<f.length;c++)f[c].parentNode.removeChild(f[c]);for(c=0;c<f.length;c++){var l=f[c],m=parseInt(l.dataset.level)+d;l.dataset.level=m}d=this._findElementIndex(g);for(c=0;c<f.length;c++)l=f[c],this._insertInside(l,d);this._updateListBox(g);
h&&this._updateListBox(h);return!0}}};c.prototype.removeItem=function(b){var a=b;"string"==typeof b&&(a=this.getItem(b));if(!a)return null;b=this.getParent(a);this.root.removeChild(a);b&&this._updateListBox(b)};c.prototype.updateItem=function(b,a){var c=this.getItem(b);c&&(c.data=a,a.id&&(c.id=a.id),a.content&&(c.title_element.querySelector(".incontent").innerHTML=a.content))};c.prototype.clear=function(b){$(b?this.root_item:this.root).find(".ltreeitem").remove()};c.prototype.unmarkAllAsSelected=
function(){this.root.classList.remove("selected");var b=this.root.querySelectorAll(".ltreeitemtitle.selected");if(b)for(var a=0;a<b.length;a++)b[a].classList.remove("selected");b=this.root.querySelectorAll(".ltreeitemtitle.semiselected");for(a=0;a<b.length;a++)b[a].classList.remove("semiselected")};c.prototype.isNodeSelected=function(b){return b.classList.contains("selected")?!0:!1};c.prototype.markAsSelected=function(b,a){if(!b.classList.contains("selected")){a||this.unmarkAllAsSelected();b.title_element.classList.add("selected");
for(var c=b.parentNode.parentNode;c&&c.classList.contains("ltreeitem");)c.title_element.classList.add("semiselected"),c=c.parentNode.parentNode}};c.prototype._updateListBox=function(b){if(b){var a=this;if(!b.listbox){var c=b.title_element.querySelector(".precontent"),g=LiteGUI.createLitebox(!0,function(c){a.onClickBox(c,b)});g.stopPropagation=!0;g.setEmpty(!0);c.appendChild(g);b.listbox=g}(c=this.getChildren(b.dataset.item_id))&&(c.length?b.listbox.setEmpty(!1):b.listbox.setEmpty(!0))}};c.prototype.onClickBox=
function(b,a){for(var c=this.getChildren(a),g=a.listbox.getValue(),d=0;d<c.length;++d)c[d].style.display="open"==g?null:"none"};LiteGUI.Tree=c})();
(function(){function c(a,b){b=b||{};this._ctor(a,b)}function b(a,b){this._ctor(a,b)}c.title_height="20px";c.prototype._ctor=function(a,b){this.content=b.content||"";var c=this.root=document.createElement("div");a&&(c.id=a);c.className="litepanel "+(b.className||"");c.data=this;var d="";b.title&&(d+="<div class='panel-header'>"+b.title+"</div>");d+="<div class='content'>"+this.content+"</div>";c.innerHTML=d+"<div class='panel-footer'></div>";b.title&&(this.header=this.root.querySelector(".panel-header"));
this.content=this.root.querySelector(".content");this.footer=this.root.querySelector(".panel-footer");!0==b.scroll&&(this.content.style.overflow="auto")};c.prototype.add=function(a){this.content.appendChild(a.root)};b.MINIMIZED_WIDTH=200;b.title_height="20px";b.getDialog=function(a){return(a=document.getElementById(a))?a.dialog:null};b.prototype._ctor=function(a,b){this.width=b.width;this.height=b.height;this.minWidth=b.minWidth||150;this.minHeight=b.minHeight||100;this.content=b.content||"";var c=
document.createElement("div");a&&(c.id=a);c.className="litedialog "+(b.className||"");c.data=this;c.dialog=this;var d="";b.title&&(d+="<div class='panel-header'>"+b.title+"</div><div class='buttons'>",b.minimize&&(d+="<button class='mini-button minimize-button'></button><button class='mini-button maximize-button' style='display:none'></button>"),b.hide&&(d+="<button class='mini-button hide-button'></button>"),b.close&&(d+="<button class='mini-button close-button'></button>"),d+="</div>");d+="<div class='content'>"+
this.content+"</div>";d+="<div class='panel-footer'></div>";c.innerHTML=d;this.root=c;this.content=$(c).find(".content")[0];this.footer=$(c).find(".panel-footer")[0];if(b.buttons)for(var f in b.buttons)this.addButton(b.buttons[f].name,b.buttons[f]);!0==b.scroll&&(this.content.style.overflow="auto");$(c).find(".close-button").bind("click",this.close.bind(this));$(c).find(".minimize-button").bind("click",this.minimize.bind(this));$(c).find(".maximize-button").bind("click",this.maximize.bind(this));
$(c).find(".hide-button").bind("click",this.hide.bind(this));this.makeDialog(b)};b.prototype.add=function(a){this.content.appendChild(a.root||a)};b.prototype.makeDialog=function(a){a=a||{};var b=this.root;b.style.position="absolute";b.style.minWidth=this.minWidth+"px";b.style.minHeight=this.minHeight+"px";this.width&&(b.style.width=this.width+"px");this.height&&("number"==typeof this.height?b.style.height=this.height+"px":-1!=this.height.indexOf("%")&&(b.style.height=this.height),this.content.style.height=
"calc( "+this.height+" - 24px )");b.style.boxShadow="0 0 3px black";a.draggable&&(this.draggable=!0,LiteGUI.draggable(b,b.querySelector(".panel-header")));a.resizable&&this.setResizable();b=null;a.parent&&(b="string"==typeof a.parent?document.querySelector(a.parent):a.parent);b||(b=LiteGUI.root);b.appendChild(this.root);this.center()};b.prototype.setResizable=function(){function a(c){if("mousedown"==c.type)document.body.addEventListener("mousemove",a),document.body.addEventListener("mouseup",a),d[0]=
c.pageX,d[1]=c.pageY;else if("mousemove"==c.type){var g=$(b).height()-(d[1]-c.pageY);$(b).height(g+"px");d[0]=c.pageX;d[1]=c.pageY;f.content.style.height="calc( 100% - 24px )"}else"mouseup"==c.type&&(document.body.removeEventListener("mousemove",a),document.body.removeEventListener("mouseup",a));c.preventDefault();return!1}if(!this.resizable){var b=this.root;this.resizable=!0;var c=this.footer;c.style.minHeight="4px";$(c).addClass("resizable");c.addEventListener("mousedown",a);var d=[0,0],f=this}};
b.prototype.dockTo=function(a,b){if(a){var c=this.root;b=b||"full";a=a.content||a;c.style.top=0;c.style.left=0;c.style.boxShadow="0 0 0";if("full"==b)c.style.position="relative",c.style.width="100%",c.style.height="100%",this.content.style.width="100%",this.content.style.height="calc(100% - "+LiteGUI.Panel.title_height+")",this.content.style.height="-moz-calc(100% - "+LiteGUI.Panel.title_height+")",this.content.style.height="-webkit-calc(100% - "+LiteGUI.Panel.title_height+")",this.content.style.overflow=
"auto";else if("left"==b||"right"==b)c.style.position="absolute",c.style.top=0,c.style[b]=0,c.style.width=this.width+"px",c.style.height="100%",this.content.style.height="-moz-calc(100% - "+LiteGUI.Panel.title_height+")",this.content.style.height="-webkit-calc(100% - "+LiteGUI.Panel.title_height+")",this.content.style.height="calc(100% - "+LiteGUI.Panel.title_height+")",this.content.style.overflow="auto","right"==b&&(c.style.left="auto",c.style.right=0);else if("bottom"==b||"top"==b)c.style.width=
"100%",c.style.height=this.height+"px","bottom"==b&&(c.style.bottom=0,c.style.top="auto");this.draggable&&$(c).draggable({disabled:!0});a.content?a.content.appendChild(c):"string"==typeof a?$(a).append(c):a.appendChild(c)}};b.prototype.addButton=function(a,b){var c=this,d=document.createElement("button");d.innerHTML=a;b.className&&(d.className=b.className);$(this.root).find(".panel-footer").append(d);$(d).bind("click",function(a){b.callback&&b.callback(this);b.close&&c.close()});return d};b.prototype.close=
function(){$(this.root).remove();$(this).trigger("closed")};b.minimized=[];b.prototype.minimize=function(){this.minimized||(this.minimized=!0,this.old_pos=$(this.root).position(),$(this.root).find(".content").hide(),$(this.root).draggable({disabled:!0}),$(this.root).find(".minimize-button").hide(),$(this.root).find(".maximize-button").show(),$(this.root).css({width:LiteGUI.Dialog.MINIMIZED_WIDTH}),$(this).bind("closed",function(){LiteGUI.Dialog.minimized.splice(LiteGUI.Dialog.minimized.indexOf(this),
1);LiteGUI.Dialog.arrangeMinimized()}),LiteGUI.Dialog.minimized.push(this),LiteGUI.Dialog.arrangeMinimized(),$(this).trigger("minimizing"))};b.arrangeMinimized=function(){for(var a in LiteGUI.Dialog.minimized){var b=$(LiteGUI.Dialog.minimized[a].root.parentNode).height()-20;$(panel.root).animate({left:LiteGUI.Dialog.MINIMIZED_WIDTH*a,top:b+"px"},100)}};b.prototype.maximize=function(){this.minimized&&(this.minimized=!1,$(this.root).find(".content").show(),$(this.root).draggable({disabled:!1}),$(this.root).animate({left:this.old_pos.left+
"px",top:this.old_pos.top+"px",width:this.width},100),$(this.root).find(".minimize-button").show(),$(this.root).find(".maximize-button").hide(),LiteGUI.Dialog.minimized.splice(LiteGUI.Dialog.minimized.indexOf(this),1),LiteGUI.Dialog.arrangeMinimized(),$(this).trigger("maximizing"))};b.prototype.makeModal=function(){LiteGUI.showModalBackground(!0);LiteGUI.modalbg_div.appendChild(this.root);this.show();this.center();$(this).bind("closed",function(a){LiteGUI.showModalBackground(!1)})};b.prototype.bringToFront=
function(){var a=$(this.root).parent();a.detach(this.root);a.attach(this.root)};b.prototype.show=function(a,b){this.root.parentNode||LiteGUI.add(this);$(this.root).show();$(this).trigger("shown")};b.prototype.hide=function(a,b){$(this.root).hide();$(this).trigger("hidden")};b.prototype.setPosition=function(a,b){this.root.position="absolute";this.root.style.left=a+"px";this.root.style.top=b+"px"};b.prototype.setSize=function(a,b){this.root.style.width=a+"px";this.root.style.height=b+"px"};b.prototype.center=
function(){this.root.position="absolute";this.root.style.left=Math.floor(0.5*($(this.root.parentNode).width()-$(this.root).width()))+"px";this.root.style.top=Math.floor(0.5*($(this.root.parentNode).height()-$(this.root).height()))+"px"};b.prototype.adjustSize=function(a){a=a||0;this.content.style.height="auto";var b=$(this.content).width();a=$(this.content).height()+20+a;this.setSize(b,a)};b.prototype.clear=function(){this.content.innerHTML=""};b.showAll=function(){for(var a=document.body.querySelectorAll("litedialog"),
b=0;b<a.length;b++)a[b].dialog.show()};b.hideAll=function(){for(var a=document.body.querySelectorAll("litedialog"),b=0;b<a.length;b++)a[b].dialog.hide()};b.closeAll=function(){for(var a=document.body.querySelectorAll("litedialog"),b=0;b<a.length;b++)a[b].dialog.close()};LiteGUI.Panel=c;LiteGUI.Dialog=b})();jQuery.fn.wchange=function(c){$(this[0]).on("wchange",c)};jQuery.fn.wclick=function(c){$(this[0]).on("wclick",c)};
function Inspector(c,b){b=b||{};this.root=document.createElement("DIV");this.root.className="inspector "+(b.full?"full":"");b.one_line&&(this.root.className+=" one-line");c&&(this.root.id=c);this.values={};this.sections=[];this.widgets={};this.addSection();this.tab_index=Math.floor(1E4*Math.random());b.name_width&&(this.name_width=b.name_width);b.parent&&this.appendTo(b.parent);this.widgets_per_row=b.widgets_per_row||1}Inspector.prototype.appendTo=function(c,b){b?$(c).prepend(this.root):$(c).append(this.root)};
Inspector.prototype.clear=function(){purgeElement(this.root,!0);$(this.root).empty();this.sections=[];this.values={};this.widgets={};this.addSection()};Inspector.prototype.append=function(c,b){var a=this.root;this.current_group_content?a=this.current_group_content:this.current_section_content&&(a=this.current_section_content);b&&b.replace?b.replace.parentNode.replaceChild(c,b.replace):a.appendChild(c)};
Inspector.prototype.setup=function(c){for(var b in c){var a=c[b];this.add(a.type,a.name,a.value,a.options)}};
Inspector.prototype.inspectInstance=function(c,b,a,e){function g(a,b){b=b||{};for(var c in a)b[c]=a[c];return b}if(c){b=!b&&c.getAttributes?c.getAttributes():this.collectAttributes(c);var d=c.constructor;!a&&d.attributes&&(a=d.attributes);var f={},h;for(h in b)if(a&&a[h])f[h]=g(a[h]);else{var l=b[h];if(d["@"+h])f[h]=g(d["@"+h]);else if(c["@"+h])f[h]=c["@"+h];else if("number"==typeof l)f[h]={type:"number",step:0.1};else if("string"==typeof l)f[h]={type:"string"};else if("boolean"==typeof l)f[h]={type:"boolean"};
else if(l&&l.length)switch(l.length){case 2:f[h]={type:"vec2",step:0.1};break;case 3:f[h]={type:"vec3",step:0.1};break;case 4:f[h]={type:"vec4",step:0.1}}}if(e)for(h in e)delete f[e[h]];return this.showAttributes(c,f)}};Inspector.prototype.collectAttributes=function(c){var b={},a;for(a in c)if("_"!=a[0]&&"@"!=a[0]&&"jQuery"!=a.substr(0,6)){var e=c[a];e&&e.constructor==Function||(b[a]=e)}return b};
Inspector.prototype.showAttributes=function(c,b){for(var a in b){var e=b[a];e.callback||(e.callback=Inspector.assignValue.bind({instance:c,name:a,options:e}));e.instance=c;this.add(e.type||e.widget||"string",a,c[a],e)}if(c.constructor.widgets)for(a in c.constructor.widgets)e=c.constructor.widgets[a],this.add(e.widget,e.name,e.value,e);if(c.onShowAttributes)c.onShowAttributes(this);if(c.constructor.onShowAttributes)c.constructor.onShowAttributes(c,this)};
Inspector.assignValue=function(c){var b=this.instance,a=b[this.name];if(null==a||null==c||"enum"==this.options.type)b[this.name]=c;else if("number"==typeof a)b[this.name]=parseFloat(c);else if("string"==typeof a)b[this.name]=c;else if(c&&c.length&&a&&a.length)for(b=0;b<c.length;++b)a[b]=c[b];else b[this.name]=c};
Inspector.prototype.createWidget=function(c,b,a){a=a||{};b=b||"";var e=document.createElement("DIV");e.className="widget "+(a.className||"");e.inspector=this;e.options=a;e.name=c;a.width&&(e.style.width="string"==typeof a.width?a.width:a.width+"px",e.style.minWidth=e.style.width);c&&(this.widgets[c]=e);1!=this.widgets_per_row&&(a.width||(e.style.width=(100/this.widgets_per_row).toFixed(2)+"%"),e.style.display="inline-block");var g="",d="";null!=c&&(this.name_width||a.name_width)&&(d=this.name_width||
a.name_width,"number"==typeof d&&(d=d.toFixed()+"px"),g="style='width: calc("+d+" - 0px); width: -webkit-calc("+d+" - 0px); width: -moz-calc("+d+" - 0px); '",d="style='width: calc( 100% - "+d+"); width: -webkit-calc(100% - "+d+"); width: -moz-calc( 100% - "+d+"); '");a="";var f="wcontent ";null==c?f+=" full":a=""==c?"<span class='wname' title='"+c+"' "+g+"></span>":"<span class='wname' title='"+c+"' "+g+">"+c+"<span class='filling'>....................</span> </span>";"string"==typeof b?e.innerHTML=
a+"<span class='info_content "+f+"' "+d+">"+b+"</span>":(e.innerHTML=a+"<span class='info_content "+f+"' "+d+"></span>",$(e).find("span.info_content").append(b));return e};Inspector.onWidgetChange=function(c,b,a,e,g){this.values[b]=a;$(this.current_section).trigger("wchange",a);var d=null;e.callback&&(d=g?e.callback.apply(c,a):e.callback.call(c,a));$(c).trigger("wchange",a);if(this.onchange)this.onchange(b,a,c);return d};
Inspector.widget_constructors={title:"addTitle",info:"addInfo",number:"addNumber",slider:"addSlider",string:"addString",text:"addString",textarea:"addTextarea",color:"addColor","boolean":"addCheckbox",checkbox:"addCheckbox",vec2:"addVector2",vector2:"addVector2",vec3:"addVector3",vector3:"addVector3",vec4:"addVector4",vector4:"addVector4","enum":"addCombo",combo:"addCombo",button:"addButton",buttons:"addButtons",file:"addFile",line:"addLine",list:"addList",tree:"addTree",datatree:"addDataTree",separator:"addSeparator"};
Inspector.registerWidget=function(c,b){var a="add"+c.charAt(0).toUpperCase()+c.slice(1);Inspector.prototype[a]=b;Inspector.widget_constructors[c]=a};
Inspector.prototype.add=function(c,b,a,e){"object"==typeof c&&1==arguments.length&&(e=c,c=e.type,b=e.name,a=e.value);var g=Inspector.widget_constructors[c];if(g){if("string"==typeof g&&(g=Inspector.prototype[g]),g&&"function"==typeof g)return"function"==typeof e&&(e={callback:e}),g.call(this,b,a,e)}else console.warn("LiteGUI.Inspector do not have a widget called",c)};Inspector.prototype.getValue=function(c){return this.values[c]};Inspector.prototype.set=function(c,b){};
Inspector.prototype.addSection=function(c,b){b=this.processOptions(b);this.current_group&&this.endGroup();var a=document.createElement("DIV");a.className="wsection";c||(a.className+=" notitle");b.className&&(a.className+=" "+b.className);b.collapsed&&(a.className+=" collapsed");b.id&&(a.id=b.id);var e="";c&&(e+="<div class='wsectiontitle'>"+(b.no_collapse?"":"<span class='switch-section-button'></span>")+c+"</div>");a.innerHTML=e+"<div class='wsectioncontent'></div>";this.root.appendChild(a);c&&a.querySelector(".wsectiontitle").addEventListener("click",
function(b){"button"!=b.target.localName&&(a.classList.toggle("collapsed"),b=a.querySelector(".wsectioncontent"),b.style.display="none"===b.style.display?"":"none")});b.collapsed&&(a.querySelector(".wsectioncontent").style.display="none");this.current_section=a;this.content=this.current_section_content=a.querySelector(".wsectioncontent");b.widgets_per_row&&(this.widgets_per_row=b.widgets_per_row);return a};
Inspector.prototype.beginGroup=function(c,b){b=this.processOptions(b);this.current_group&&this.endGroup();var a=document.createElement("DIV");a.className="wgroup";a.innerHTML="<div class='wgroupheader "+(b.title?"wtitle":"")+"'><span class='wgrouptoggle'>-</span>"+(c||"")+"</div>";var e=document.createElement("DIV");e.className="wgroupcontent";b.collapsed&&(e.style.display="none");a.appendChild(e);var g=b.collapsed||!1;a.querySelector(".wgroupheader").addEventListener("click",function(){var b=a.querySelector(".wgroupcontent").style;
b.display="none"===b.display?"":"none";g=!g;a.querySelector(".wgrouptoggle").innerHTML=g?"+":"-"});this.append(a,b);this.current_group=a;this.content=this.current_group_content=e;return a};Inspector.prototype.endGroup=function(c){this.current_group_content=this.current_group=null;this.content=this.current_section_content};
Inspector.prototype.addTitle=function(c,b){b=this.processOptions(b);var a=document.createElement("DIV"),e="<span class='wtitle'><span class='text'>"+c+"</span>";b.help&&(e+="<span class='help'><div class='help-content'>"+b.help+"</div></span>");a.innerHTML=e+"</span>";a.setValue=function(a){$(this).find(".text").html(a)};this.append(a,b);return a};Inspector.prototype.addSeparator=function(){var c=document.createElement("DIV");c.className="separator";this.append(c);return c};
Inspector.prototype.addString=function(c,b,a){a=this.processOptions(a);b=b||"";var e=this;this.values[c]=b;var g="text";a.password&&(g="password");var d=this.createWidget(c,"<span class='inputfield full "+(a.disabled?"disabled":"")+"'><input type='"+g+"' tabIndex='"+this.tab_index+"' "+(a.focus?"autofocus":"")+" class='text string' value='"+b+"' "+(a.disabled?"disabled":"")+"/></span>",a),f=d.querySelector(".wcontent input");f.addEventListener(a.immediate?"keyup":"change",function(b){b=Inspector.onWidgetChange.call(e,
d,c,b.target.value,a);void 0!==b&&(this.value=b)});this.tab_index+=1;d.setValue=function(a){f.value=a;LiteGUI.trigger(f,"change")};d.getValue=function(){return f.value};d.focus=function(){$(this).find("input").focus()};d.wchange=function(a){$(this).wchange(a)};this.append(d,a);return d};
Inspector.prototype.addStringButton=function(c,b,a){a=this.processOptions(a);b=b||"";var e=this;this.values[c]=b;var g=this.createWidget(c,"<span class='inputfield button'><input type='text' tabIndex='"+this.tab_index+"' class='text string' value='"+b+"' "+(a.disabled?"disabled":"")+"/></span><button class='micro'>"+(a.button||"...")+"</button>",a),d=g.querySelector(".wcontent input");d.addEventListener("change",function(b){Inspector.onWidgetChange.call(e,g,c,b.target.value,a)});g.querySelector(".wcontent button").addEventListener("click",
function(b){a.callback_button&&a.callback_button.call(g,d.value)});this.tab_index+=1;this.append(g,a);g.wchange=function(a){$(this).wchange(a)};g.wclick=function(a){$(this).wclick(a)};g.setValue=function(a){d.value=a;LiteGUI.trigger(d,"change")};g.getValue=function(){return d.value};g.focus=function(){$(this).find("input").focus()};return g};
Inspector.prototype.addNumber=function(c,b,a){a=this.processOptions(a);a.step||(a.step=0.1);b=b||0;var e=this;this.values[c]=b;var g=this.createWidget(c,"",a);this.append(g,a);a.extraclass="full";a.tab_index=this.tab_index;a.full=!0;this.tab_index++;b=new LiteGUI.Dragger(b,a);b.root.style.width="calc( 100% - 1px )";$(g).find(".wcontent").append(b.root);$(b.root).bind("start_dragging",function(a){this.callback_before&&this.callback_before.call(g)}.bind(a));$(g).find("input").change(function(b){e.values[c]=
b.target.value;if(a.callback){var f=a.callback.call(g,parseFloat(b.target.value));"number"==typeof f&&$(this).val(f)}$(g).trigger("wchange",b.target.value);if(e.onchange)e.onchange(c,b.target.value,g)});g.setValue=function(a){$(this).find("input").val(a).change()};g.getValue=function(){return $(this).find("input").val()};g.focus=function(){$(this).find("input").focus()};return g};
Inspector.prototype.addVector2=function(c,b,a){function e(a){this.callback_before&&this.callback_before(a)}a=this.processOptions(a);a.step||(a.step=0.1);b=b||[0,0];var g=this;this.values[c]=b;var d=this.createWidget(c,"",a);a.step=a.step||0.1;a.tab_index=this.tab_index;a.full=!0;this.tab_index++;var f=new LiteGUI.Dragger(b[0],a);f.root.style.marginLeft=0;f.root.style.width="calc( 50% - 1px )";$(d).find(".wcontent").append(f.root);a.tab_index=this.tab_index;this.tab_index++;var h=new LiteGUI.Dragger(b[1],
a);h.root.style.width="calc( 50% - 1px )";$(d).find(".wcontent").append(h.root);$(f.root).bind("start_dragging",e.bind(a));$(h.root).bind("start_dragging",e.bind(a));$(d).find("input").change(function(b){b=[];for(var e=$(d).find("input"),f=0;f<e.length;f++)b.push(parseFloat(e[f].value));g.values[c]=b;if(a.callback){var h=a.callback.call(d,b);if("object"==typeof h&&2<=h.length){for(f=0;f<e.length;f++)$(e[f]).val(h[f]);b=h}}$(d).trigger("wchange",[b]);if(g.onchange)g.onchange(c,b,d)});this.append(d,
a);d.setValue=function(a){f.setValue(a[0]);h.setValue(a[1])};return d};
Inspector.prototype.addVector3=function(c,b,a){function e(a){this.callback_before&&this.callback_before()}a=this.processOptions(a);a.step||(a.step=0.1);b=b||[0,0,0];var g=this;this.values[c]=b;var d=this.createWidget(c,"",a);a.step=a.step||0.1;a.tab_index=this.tab_index;a.full=!0;this.tab_index++;var f=new LiteGUI.Dragger(b[0],a);f.root.style.marginLeft=0;f.root.style.width="calc( 33% - 1px )";$(d).find(".wcontent").append(f.root);a.tab_index=this.tab_index;this.tab_index++;var h=new LiteGUI.Dragger(b[1],
a);h.root.style.width="calc( 33% - 1px )";$(d).find(".wcontent").append(h.root);a.tab_index=this.tab_index;this.tab_index++;var l=new LiteGUI.Dragger(b[2],a);l.root.style.width="calc( 33% - 1px )";$(d).find(".wcontent").append(l.root);$(f.root).bind("start_dragging",e.bind(a));$(h.root).bind("start_dragging",e.bind(a));$(l.root).bind("start_dragging",e.bind(a));$(d).find("input").change(function(b){b=[];for(var e=$(d).find("input"),f=0;f<e.length;f++)b.push(parseFloat(e[f].value));g.values[c]=b;if(a.callback){var h=
a.callback.call(d,b);if("object"==typeof h&&3<=h.length){for(f=0;f<e.length;f++)$(e[f]).val(h[f]);b=h}}$(d).trigger("wchange",[b]);if(g.onchange)g.onchange(c,b,d)});this.append(d,a);d.setValue=function(a){f.setValue(a[0]);h.setValue(a[1]);l.setValue(a[2])};return d};
Inspector.prototype.addVector4=function(c,b,a){function e(a){this.callback_before&&this.callback_before()}a=this.processOptions(a);a.step||(a.step=0.1);b=b||[0,0,0];var g=this;this.values[c]=b;var d=this.createWidget(c,"",a);a.step=a.step||0.1;a.tab_index=this.tab_index;a.full=!0;this.tab_index++;for(var f=[],h=0;4>h;h++){var l=new LiteGUI.Dragger(b[h],a);l.root.style.marginLeft=0;l.root.style.width="calc( 25% - 1px )";$(d).find(".wcontent").append(l.root);a.tab_index=this.tab_index;this.tab_index++;
$(l.root).bind("start_dragging",e.bind(a));f.push(l)}$(d).find("input").change(function(b){b=[];for(var e=$(d).find("input"),f=0;f<e.length;f++)b.push(parseFloat(e[f].value));g.values[c]=b;if(a.callback){var h=a.callback.call(d,b);if("object"==typeof h&&4<=h.length){for(f=0;f<e.length;f++)$(e[f]).val(h[f]);b=h}}$(d).trigger("wchange",[b]);if(g.onchange)g.onchange(c,b,d)});this.append(d,a);d.setValue=function(a){for(var b=0;b<f.length;b++)f[b].setValue(a[b])};return d};
Inspector.prototype.addTextarea=function(c,b,a){a=this.processOptions(a);b=b||"";var e=this;this.values[c]=b;var g=this.createWidget(c,"<span class='inputfield textarea "+(a.disabled?"disabled":"")+"'><textarea tabIndex='"+this.tab_index+"' "+(a.disabled?"disabled":"")+">"+b+"</textarea></span>",a);this.tab_index++;g.querySelector(".wcontent textarea").addEventListener(a.immediate?"keyup":"change",function(b){Inspector.onWidgetChange.call(e,g,c,b.target.value,a)});a.height&&$(g).find("textarea").css({height:a.height});
this.append(g,a);g.setValue=function(a){$(this).find("textarea").val(a).change()};return g};
Inspector.prototype.addInfo=function(c,b,a){a=this.processOptions(a);b=b||"";var e=null;null!=c?e=this.createWidget(c,b,a):(e=document.createElement("div"),a.className&&(e.className=a.className),e.innerHTML="<span class='winfo'>"+b+"</span>");var g=e.querySelector(".winfo");e.setValue=function(a){g.innerHTML=a};a.height&&(c=e.querySelector("span.info_content"),c.style.height="string"==typeof a.height?a.height:a.height+"px",c.style.overflow="auto");this.append(e,a);return e};
Inspector.prototype.addSlider=function(c,b,a){a=this.processOptions(a);void 0===a.min&&(a.min=0);void 0===a.max&&(a.max=1);void 0===a.step&&(a.step=0.01);var e=this;this.values[c]=b;var g=this.createWidget(c,"<span class='inputfield full'>\t\t\t\t<input tabIndex='"+this.tab_index+"' type='text' class='slider-text fixed nano' value='"+b+"' /><span class='slider-container'></span></span>",a),d=g.querySelector(".slider-container"),f=new LiteGUI.Slider(b,a);d.appendChild(f.root);var h=g.querySelector(".slider-text");
$(h).on("change",function(){var b=parseFloat($(this).val());f.setValue(b);Inspector.onWidgetChange.call(e,g,c,b,a)});$(f.root).on("change",function(b,d){h.value=d;Inspector.onWidgetChange.call(e,g,c,d,a)});this.append(g,a);g.setValue=function(a){f.setValue(a)};return g};
Inspector.prototype.addCheckbox=function(c,b,a){a=this.processOptions(a);b=b||"";var e=this;this.values[c]=b;var g=a.label_on||a.label||"on",d=a.label_off||a.label||"off",f=this.createWidget(c,"<span class='inputfield'><span tabIndex='"+this.tab_index+"' class='fixed flag checkbox "+(b?"on":"off")+"'>"+(b?g:d)+"</span></span>",a);this.tab_index++;$(f).find(".wcontent .checkbox").keypress(function(a){32==a.keyCode&&$(this).click()});$(f).click(function(){var b=!this.data;this.data=b;$(f).find("span.flag").html(b?
g:d);b?$(f).find("span.checkbox").addClass("on"):$(f).find("span.checkbox").removeClass("on");Inspector.onWidgetChange.call(e,f,c,b,a)})[0].data=b;f.setValue=function(a){e.values[c]!=a&&$(this).find(".checkbox").click()};this.append(f,a);return f};Inspector.prototype.addFlags=function(c,b){var a={},e;for(e in c)a[e]=c[e];if(b)for(e in b)"undefined"==typeof a[e]&&(a[e]=b[e]?!0:!1);for(e in a)this.addCheckbox(e,a[e],{callback:function(a){return function(b){c[a]=b}}(e)})};
Inspector.prototype.addCombo=function(c,b,a){a=this.processOptions(a);var e=this;this.values[c]=b;var g="<select tabIndex='"+this.tab_index+"' "+(a.disabled?"disabled":"")+" class='"+(a.disabled?"disabled":"")+"'>";this.tab_index++;var d=this.createWidget(c,"<span class='inputfield full inputcombo "+(a.disabled?"disabled":"")+"'></span>",a);d.options=a;var f=a.values||[];if(a.values&&(f="function"==typeof f?a.values():a.values))for(var h in f)g+="<option "+(f[h]==b?" selected":"")+">"+(f.length?f[h]:
h)+"</option>";g+="</select>";d.querySelector("span.inputcombo").innerHTML=g;$(d).find(".wcontent select").change(function(b){b=b.target.value;f&&f.constructor!=Array&&(b=f[b]);Inspector.onWidgetChange.call(e,d,c,b,a)});this.append(d,a);return d};
Inspector.prototype.addComboButtons=function(c,b,a){a=this.processOptions(a);b=b||"";var e=this;this.values[c]=b;var g="";if(a.values)for(var d in a.values)g+="<button class='wcombobutton "+(b==a.values[d]?"selected":"")+"' data-name='options.values[i]'>"+a.values[d]+"</button>";var f=this.createWidget(c,g,a);$(f).find(".wcontent button").click(function(b){b=b.target.innerHTML;e.values[c]=b;$(f).find(".selected").removeClass("selected");$(this).addClass("selected");Inspector.onWidgetChange.call(e,
f,c,b,a)});this.append(f,a);return f};
Inspector.prototype.addTags=function(c,b,a){function e(b){if(!f.tags[b]){f.tags[b]=!0;var d=document.createElement("div");d.data=b;d.className="wtag";d.innerHTML=b+"<span class='close'>X</span>";d.querySelector(".close").addEventListener("click",function(b){b=$(this).parent()[0].data;delete f.tags[b];$(this).parent().remove();$(f).trigger("wremoved",b);Inspector.onWidgetChange.call(g,f,c,f.tags,a)});f.querySelector(".wtagscontainer").appendChild(d);g.values[c]=f.tags;a.callback&&a.callback.call(f,
f.tags);$(f).trigger("wchange",f.tags);$(f).trigger("wadded",b);if(g.onchange)g.onchange(c,f.tags,f)}}a=this.processOptions(a);b=b||[];var g=this;this.values[c]=b;b="<select>";if(a.values)for(var d in a.values)b+="<option>"+a.values[d]+"</option>";var f=this.createWidget(c,"<span class='inputfield full'>"+(b+"</select><div class='wtagscontainer inputfield'></div>")+"</span>",a);f.tags={};for(d in a.value)e(a.value[d]);$(f).find(".wcontent select").change(function(a){e(a.target.value)});this.append(f,
a);return f};
Inspector.prototype.addList=function(c,b,a){function e(a){var b=$(h).find("li.selected");b&&b.length&&(40==a.keyCode?(a=b.next())&&a.length&&$(a[0]).click():38==a.keyCode&&(a=b.prev())&&a.length&&$(a[0]).click())}function g(e){a.multiselection?$(this).toggleClass("selected"):($(h).find("li").removeClass("selected"),$(this).addClass("selected"));e=b[this.dataset.pos];Inspector.onWidgetChange.call(d,h,c,e,a);$(h).trigger("wadded",e)}a=this.processOptions(a);var d=this,f="";a.height&&(f="style='height: "+
a.height+"px; overflow: auto;'");f="<ul class='lite-list' "+f+" tabIndex='"+this.tab_index+"'><ul>";this.tab_index++;var h=this.createWidget(c,"<span class='inputfield full "+(a.disabled?"disabled":"")+"'>"+f+"</span>",a);$(h).find("ul").focus(function(){$(document).on("keypress",e)});$(h).find("ul").blur(function(){$(document).off("keypress",e)});h.updateItems=function(a){var c="";if(b=a)for(var d in b){a=b[d];var e="";null==b[d].length&&(a=b[d].name?b[d].name:d,b[d].icon&&(e="<img src='"+b[d].icon+
"' class='icon' />"));c+="<li className='item-"+d+" "+("object"==typeof b[d]&&b[d].selected?"selected":"")+"' data-name='"+a+"' data-pos='"+d+"'>"+e+a+"</li>"}this.querySelector("ul").innerHTML=c;$(this).find(".wcontent li").click(g)};h.removeItem=function(a){for(var b=$(h).find(".wcontent li"),c=0;c<b.length;c++)b[c].dataset.name==a&&$(b[c]).remove()};h.updateItems(b);this.append(h,a);h.getSelected=function(){for(var a=[],b=this.querySelectorAll("ul li.selected"),c=0;c<b.length;++c)a.push(b[c].dataset.name);
return a};h.selectAll=function(){for(var a=this.querySelectorAll("ul li"),b=0;b<a.length;++b){var c=a[b];$(c).hasClass("selected")||$(c).click()}return r};a.height&&$(h).scroll(0);return h};
Inspector.prototype.addButton=function(c,b,a){a=this.processOptions(a);b=b||"";var e=this,g="";null===c&&(g="single");var d=this.createWidget(c,"<button class='"+g+"' tabIndex='"+this.tab_index+"'>"+b+"</button>",a);this.tab_index++;$(d).find("button").click(function(){Inspector.onWidgetChange.call(e,d,c,this.innerHTML,a);$(d).trigger("wclick",b)});this.append(d,a);d.wclick=function(b){a.disabled||$(this).wclick(b)};return d};
Inspector.prototype.addButtons=function(c,b,a){a=this.processOptions(a);b=b||"";var e=this,g="",d="calc("+(100/b.length).toFixed(3)+"% - "+Math.floor(16/b.length)+"px);";if(b&&"object"==typeof b)for(var f in b)g+="<button tabIndex='"+this.tab_index+"' style=' width:"+d+" width: -moz-"+d+" width: -webkit-calc("+(89/b.length).toFixed(3)+"%)'>"+b[f]+"</button>",this.tab_index++;var h=this.createWidget(c,g,a);$(h).find("button").click(function(){Inspector.onWidgetChange.call(e,h,c,this.innerHTML,a);$(h).trigger("wclick",
this.innerHTML)});this.append(h,a);return h};
Inspector.prototype.addColor=function(c,b,a){a=this.processOptions(a);b=b||[0,0,0];var e=this;this.values[c]=b;var g="<input tabIndex='"+this.tab_index+"' id='colorpicker-"+c+"' class='color' value='"+(b[0]+","+b[1]+","+b[2])+"' "+(a.disabled?"disabled":"")+"/>";this.tab_index++;a.show_rgb&&(g+="<span class='rgb-color'>"+Inspector.parseColor(b)+"</span>");var d=this.createWidget(c,g,a);this.append(d,a);var g=$(d).find("input.color")[0],f=new jscolor.color(g);f.pickerFaceColor="#333";f.pickerBorderColor=
"black";f.pickerInsetColor="#222";f.rgb_intensity=1;a.disabled&&(f.pickerOnfocus=!1);"string"!=typeof b&&b.length&&2<b.length&&(f.fromRGB(1*b[0],1*b[1],1*b[2]),f.rgb_intensity=1);g.addEventListener("change",function(a){if(a=d.querySelector(".rgb-color"))a.innerHTML=LiteGUI.Inspector.parseColor(f.rgb)});f.onImmediateChange=function(){var b=[f.rgb[0]*f.rgb_intensity,f.rgb[1]*f.rgb_intensity,f.rgb[2]*f.rgb_intensity];e.values[c]=b;a.callback&&a.callback.call(d,b.concat(),"#"+f.toString(),f);$(d).trigger("wchange",
[b.concat(),f.toString()]);if(e.onchange)e.onchange(c,b.concat(),d)};a.step=a.step||0.01;a.dragger_class="nano";var h=new LiteGUI.Dragger(1,a);$(d).find(".wcontent").append(h.root);$(h.input).change(function(){var a=parseFloat($(this).val());f.rgb_intensity=a;if(f.onImmediateChange)f.onImmediateChange()});d.setValue=function(a){f.fromRGB(a[0],a[1],a[2]);$(h.input).change()};return d};
Inspector.prototype.addFile=function(c,b,a){a=this.processOptions(a);b=b||"";var e=this;this.values[c]=b;var g=this.createWidget(c,"<span class='inputfield full whidden'><span class='filename'>"+b+"</span><input type='file' size='100' class='file' value='"+b+"'/></span>",a);g.querySelector(".wcontent input").addEventListener("change",function(b){if(b.target.files.length){var f=null;a.generate_url&&(f=URL.createObjectURL(b.target.files[0]));f={url:f,filename:b.target.value,file:b.target.files[0],files:b.target.files};
$(g).find(".filename").html(b.target.value);Inspector.onWidgetChange.call(e,g,c,f,a)}else $(g).find(".filename").html(""),Inspector.onWidgetChange.call(e,g,c,null,a)});this.append(g,a);return g};
Inspector.prototype.addLine=function(c,b,a){a=this.processOptions(a);b=b||"";var e=this;this.values[c]=b;var g=this.createWidget(c,"<span class='line-editor'></span>",a);b=new LiteGUI.LineEditor(b,a);$(g).find("span.line-editor").append(b);$(b).change(function(b){a.callback&&a.callback.call(g,b.target.value);$(g).trigger("wchange",[b.target.value]);Inspector.onWidgetChange.call(e,g,c,b.target.value,a)});this.append(g,a);return g};
Inspector.prototype.addTree=function(c,b,a){a=this.processOptions(a);b=b||"";c=this.createWidget(c,"<div class='wtree inputfield full'></div>",a);var e=$(c).find(".wtree")[0];a.height&&(e.style.height="number"==typeof a.height?a.height+"px":a.height);var g=c.tree=new LiteGUI.Tree(null,b,a.tree_options);g.onItemSelected=function(b,c){a.callback&&a.callback(b,c)};e.appendChild(g.root);c.setValue=function(a){g.updateTree(a)};this.append(c,a);return c};
Inspector.prototype.addDataTree=function(c,b,a){function e(a,b){for(var c in b){var g=document.createElement("div");g.className="treenode";"object"==typeof b[c]?(g.innerHTML="<span class='itemname'>"+c+"</span><span class='itemcontent'></span>",e($(g).find(".itemcontent")[0],b[c])):g.innerHTML="<span class='itemname'>"+c+"</span><span class='itemvalue'>"+b[c]+"</span>";a.appendChild(g)}}a=this.processOptions(a);b=b||"";c=this.createWidget(c,"<div class='wtree'></div>",a);var g=$(c).find(".wtree")[0];
e(g,b);this.append(c,a);return c};Inspector.prototype.scrollTo=function(c){if(c=this.root.querySelector("#"+c))this.root.parentNode.parentNode.scrollTop=c.offsetTop-this.root.offsetTop};Inspector.prototype.processOptions=function(c){"function"==typeof c&&(c={callback:c});return c||{}};Inspector.parseColor=function(c){return"<span style='color: #FAA'>"+c[0].toFixed(2)+"</span>,<span style='color: #AFA'>"+c[1].toFixed(2)+"</span>,<span style='color: #AAF'>"+c[2].toFixed(2)+"</span>"};
LiteGUI.Inspector=Inspector;
