var trace=console?console.log.bind(console):function(){},LiteGUI={root_container:null,panels:{},undo_steps:[],modalbg_div:null,_modules_initialized:!1,mainmenu:null,modules:[],init:function(c){c=c||{};trace("Init lite");c.width&&c.height&&this.setWindowSize(c.width,c.height);this.root_container=$("#work-area")[0];this.modalbg_div=document.createElement("div");this.modalbg_div.className="litemodalbg";$(document.body).append(this.modalbg_div);c.menubar&&(this.mainmenu=new LiteGUI.Menubar("mainmenubar"),
$(c.menubar).append(this.mainmenu.root));c.gui_callback&&c.gui_callback();!1!=c.initModules&&this.initModules();$(document).bind("keydown",function(a){"input"!=a.target.nodeName.toLowerCase()&&"textarea"!=a.target.nodeName.toLowerCase()&&17!=a.keyCode&&((26==a.keyCode||90==a.keyCode&&(a.ctrlKey||a.metaKey)||122==a.charCode&&a.ctrlKey)&&LiteGUI.doUndo(),27==a.keyCode&&$(LiteGUI).trigger("escape"))});$("#wrap").hasClass("fullscreen")&&$(window).resize(function(a){LiteGUI.maximizeWindow()})},initModules:function(){for(var c in this.modules)this.modules[c].init_gui&&
this.modules[c].init_gui();for(c in this.modules)this.modules[c].init&&!this.modules[c]._initialized&&(this.modules[c].init(),this.modules[c]._initialized=!0);this._modules_initialized=!0},registerModule:function(c){this.modules.push(c);this._modules_initialized&&(c.init_gui&&c.init_gui(),c.init&&c.init());$(this).trigger("module_registered",c)},setWindowSize:function(c,a){if(c&&a)$("#wrap").css({width:c+"px",height:a+"px","box-shadow":"0 0 4px black"}).removeClass("fullscreen");else{if($("#wrap").hasClass("fullscreen"))return;
$("#wrap").addClass("fullscreen");$("#wrap").css({width:"100%",height:"100%","box-shadow":"0 0 0"})}$(LiteGUI).trigger("resized")},maximizeWindow:function(){this.setWindowSize()},max_undo_steps:100,min_time_between_undos:500,last_undo_time:0,addUndoStep:function(c){var a=(new Date).getTime();a-this.last_undo_time<this.min_time_between_undos||(this.undo_steps.push(c),this.last_undo_time=a,this.undo_steps.length>this.max_undo_steps&&this.undo_steps.shift())},doUndo:function(){if(this.undo_steps.length){var c=
this.undo_steps.pop();null!=c.callback&&c.callback(c.data);$(LiteGUI).trigger("undo",c)}},removeUndoSteps:function(){this.undo_steps=[]},toClipboard:function(c){null!=c&&localStorage.setItem("lite_clipboard",JSON.stringify(c))},getClipboard:function(){var c=localStorage.getItem("lite_clipboard");return c?JSON.parse(c):null},addCSS:function(c){var a=document.createElement("style");a.type="text/css";a.innerHTML=c;document.getElementsByTagName("head")[0].appendChild(a)},requireCSS:function(c,a){for("string"==
typeof c&&(c=[c]);c.length;){var b=document.createElement("link");b.rel="stylesheet";b.type="text/css";b.href=c.shift(1);b.media="all";document.getElementsByTagName("head")[0].appendChild(b);0==c.length&&(b.onload=a)}},requireScript:function(c,a){function b(){var d=document.createElement("script");d.type="text/javascript";d.src=c.shift(1);d.onload=function(d){c.length?b():a&&a()};document.getElementsByTagName("head")[0].appendChild(d)}"string"==typeof c&&(c=[c]);b()},showModalBackground:function(c){c?
$(LiteGUI.modalbg_div).show("fade"):$(LiteGUI.modalbg_div).hide("fade")},showMessage:function(c,a){a=a||{};a.title=a.title||"Attention";a.content=c;a.close="fade";var b=new LiteGUI.Dialog("info_message",a);a.noclose||b.addButton("Close",{close:!0});b.makeModal("fade");return b},alert:function(c,a){a=a||{};a.className="alert";a.title="Alert";a.width=280;a.height=140;"string"==typeof c&&(c="<p>"+c+"</p>");$(".litepanel.alert").remove();return this.showMessage(c,a)},confirm:function(c,a,b,d){a=a||{};
"function"==typeof a&&(d=b,b=a,a={});a.className="alert";a.title="Confirm";a.width=280;a.height=140;"string"==typeof c&&(c="<p>"+c+"</p>");a.noclose=!0;var e=this.showMessage(c+"<button class='yes-button' style='width:45%; margin-left: 10px'>Yes</button><button class='no-button' style='width:45%'>No</button>",a);$(e.content).find(".yes-button").click(function(){b&&b();e.close()});$(e.content).find(".no-button").click(function(){d&&d();e.close()});return e},prompt:function(c,a,b,d){a=a||{};"function"==
typeof a&&(d=b,b=a,a={});a.className="alert";a.title="Prompt";a.width=280;a.height=140+(a.textarea?40:0);"string"==typeof c&&(c="<p>"+c+"</p>");var e=a.value||"",f="<input type='text' value='"+e+"'/>";a.textarea&&(f="<textarea class='textfield' style='width:95%'>"+e+"</textarea>");a.noclose=!0;var g=this.showMessage(c+("<p>"+f+"</p><button class='yes-button' style='width:45%; margin-left: 10px'>Accept</button><button class='no-button' style='width:45%'>Cancel</button>"),a);$(g.content).find(".yes-button").click(function(){var d=
$(g.content).find(a.textarea?"textarea":"input").val();b&&b(d);g.close()});$(g.content).find(".no-button").click(function(){d&&d();g.close()});return g},getUrlVars:function(){for(var c=[],a,b=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),d=0;d<b.length;d++)a=b[d].split("="),c.push(a[0]),c[a[0]]=a[1];return c},getUrlVar:function(c){return LiteGUI.getUrlVars()[c]}};
(function(){function c(a,b){b=b||{};var d=document.createElement("div");d.className="litearea";a&&(d.id=a);this.root=d;this.root.litearea=this;this.options=b;var c=this;window.addEventListener("resize",function(a){c.resize(a)});this._computed_size=[$(this.root).width(),$(this.root).height()];d=document.createElement("div");b.content_id&&(d.id=b.content_id);d.className="liteareacontent";d.style.width="100%";d.style.height="100%";this.root.appendChild(d);this.content=d;this.split_direction="none";this.sections=
[];b.main&&$(LiteGUI).bind("resized",function(){c.resize()})}c.prototype.getSection=function(a){a=a||0;return this.sections.length>a?this.sections[a]:null};c.prototype.resize=function(a){var b=[$(this.root).width(),$(this.root).height()];if(!a||!this._computed_size||b[0]!=this._computed_size[0]||b[1]!=this._computed_size[1])if(this.sections.length)for(var d in this.sections)this.sections[d].resize(a);else for(a=0;a<this.root.childNodes.length;a++)b=this.root.childNodes[a],b.litearea?b.litearea.resize():
$(b).trigger("resize")};c.prototype.split=function(a,b,d){function c(a){$(document).bind("mousemove",f);$(document).bind("mouseup",g);r[0]=a.pageX;r[1]=a.pageY;trace("Dragging");a.stopPropagation();a.preventDefault()}function f(b){"horizontal"==a?r[0]!=b.pageX&&p.moveSplit(r[0]-b.pageX):"vertical"==a&&r[1]!=b.pageY&&p.moveSplit(r[1]-b.pageY);r[0]=b.pageX;r[1]=b.pageY;b.stopPropagation();b.preventDefault();p.options.inmediateResize&&p.resize()}function g(a){trace("Stop Dragging");$(document).unbind("mousemove",
f);$(document).unbind("mouseup",g);p.resize()}a=a||"vertical";if(this.sections.length)throw"cannot split twice";var h=new LiteGUI.Area(null,{content_id:this.content.id});h.root.style.display="inline-block";var l=new LiteGUI.Area;l.root.style.display="inline-block";var m="",k=null,n=null;d&&(m=" - 5px",k=document.createElement("div"),k.className="litesplitbar "+a,$(k).bind("mousedown",c));b=b||["50%",null];"vertical"==a?(h.root.style.width="100%",l.root.style.width="100%",null==b[0]?(h.root.style.height=
"-moz-calc( 100% - "+b[1]+m+" )",h.root.style.height="-webkit-calc( 100% - "+b[1]+m+" )",h.root.style.height="calc( 100% - "+b[1]+m+" )",l.root.style.height=b[1],l.size=b[1],n=h):null==b[1]?(h.root.style.height=b[0],h.size=b[0],l.root.style.height="-moz-calc( 100% - "+b[0]+m+" )",l.root.style.height="-webkit-calc( 100% - "+b[0]+m+" )",l.root.style.height="calc( 100% - "+b[0]+m+" )",n=l):(h.root.style.height=b[0],h.size=b[0],l.root.style.height=b[1],l.size=b[1])):(h.root.style.height="100%",l.root.style.height=
"100%",null==b[0]?(h.root.style.width="-moz-calc( 100% - "+b[1]+m+" )",h.root.style.width="-webkit-calc( 100% - "+b[1]+m+" )",h.root.style.width="calc( 100% - "+b[1]+m+" )",l.root.style.width=b[1],l.size=b[1],n=h):null==b[1]?(h.root.style.width=b[0],h.size=b[0],l.root.style.width="-moz-calc( 100% - "+b[0]+m+" )",l.root.style.width="-webkit-calc( 100% - "+b[0]+m+" )",l.root.style.width="calc( 100% - "+b[0]+m+" )",n=l):(h.root.style.width=b[0],h.size=b[0],l.root.style.width=b[1],l.size=b[1]));h.root.removeChild(h.content);
h.root.appendChild(this.content);h.content=this.content;this.root.appendChild(h.root);k&&this.root.appendChild(k);this.root.appendChild(l.root);this.sections=[h,l];this.dynamic_section=n;this.direction=a;var p=this,r=[0,0]};c.prototype.moveSplit=function(a){if(this.sections){var b=this.sections[0],d=this.sections[1];"horizontal"==this.direction?this.dynamic_section==b?(a=$(d.root).width()+a+"px",b.root.style.width="-moz-calc( 100% - "+a+" - 2px )",b.root.style.width="-webkit-calc( 100% - "+a+" - 2px )",
b.root.style.width="calc( 100% - "+a+" - 2px )",d.root.style.width=a):(a=$(b.root).width()-a+"px",b.root.style.width=a,d.root.style.width="-moz-calc( 100% - "+a+" - 2px )",d.root.style.width="-webkit-calc( 100% - "+a+" - 2px )",d.root.style.width="calc( 100% - "+a+" - 2px )"):"vertical"==this.direction&&(this.dynamic_section==b?(a=$(d.root).height()+a+"px",b.root.style.height="-moz-calc( 100% - "+a+" - 2px )",b.root.style.height="-webkit-calc( 100% - "+a+" - 2px )",b.root.style.height="calc( 100% - "+
a+" - 2px )",d.root.style.height=a):(a=$(b.root).height()+a+"px",b.root.style.height=a,d.root.style.height="-moz-calc( 100% - "+a+" - 2px )",d.root.style.height="-webkit-calc( 100% - "+a+" - 2px )",d.root.style.height="calc( 100% - "+a+" - 2px )"))}};c.prototype.setAreaSize=function(a,b){var d=this.sections[1];d.root.style.width="-moz-calc( 100% - "+b+" - 2px )";d.root.style.width="-webkit-calc( 100% - "+b+" - 2px )";d.root.style.width="calc( 100% - "+b+" - 2px )"};c.prototype.merge=function(a){if(0==
this.sections.length)throw"not splitted";a=this.sections[a||0];this.root.appendChild(a.content);this.content=a.content;this.root.removeChild(this.sections[0].root);this.root.removeChild(this.sections[1].root);this.sections=[];this._computed_size=null;this.resize()};c.prototype.hideSection=function(a){if(0==this.sections.length)throw"not splitted";};LiteGUI.Area=c;LiteGUI.Split=function(a,b,d){d=d||{};var c=document.createElement("div");this.root=c;c.id=a;c.className="litesplit "+(d.vertical?"vsplit":
"hsplit");this.sections=[];for(var f in b)a=document.createElement("div"),a.className="split-section split"+f,"number"==typeof b[f]?d.vertical?a.style.height=b[f].toFixed(1)+"%":a.style.width=b[f].toFixed(1)+"%":"string"==typeof b[f]?d.vertical?a.style.height=b[f]:a.style.width=b[f]:(b[f].id&&(a.id=b[f].id),d.vertical?a.style.height="Number"==typeof b[f].height?b[f].height.toFixed(1)+"%":b[f].height:a.style.width="Number"==typeof b[f].width?b[f].width.toFixed(1)+"%":b[f].width),this.sections.push(a),
c.appendChild(a);d.parent&&(d.parent.root?d.parent.root.appendChild(c):d.parent.appendChild(c))};LiteGUI.ContextualMenu=function(a,b){this.options=b=b||{};var d=this,c=document.createElement("div");c.className="litecontextualmenu litemenubar-panel";c.style.minWidth=100;c.style.minHeight=100;this.root=c;for(var f in a){var g=document.createElement("div");g.className="litemenu-entry submenu";g.dataset.value=a[f];g.innerHTML=a.constructor==Array?a[f]:f;c.appendChild(g)}$(c).find(".litemenu-entry").click(function(a){a=
this.dataset.value;b.callback&&b.callback.call(d,a);document.body.removeChild(c)});$(c).mouseleave(function(a){document.body.removeChild(c)});document.body.appendChild(c);f=b.left||0;g=b.top||0;if(b.event){f=b.event.pageX-10;var g=b.event.pageY-10,h=document.body.getClientRects()[0];f>h.width-$(c).width()-10&&(f=h.width-$(c).width()-10);g>h.height-$(c).height()-10&&(g=h.height-$(c).height()-10)}c.style.left=f+"px";c.style.top=g+"px"};LiteGUI.createLitebox=function(a,b){var d=document.createElement("span");
d.className="listbox listopen";d.innerHTML="-";d.dataset.value=a?"open":"closed";d.addEventListener("click",function(a){console.log("CLICK");a.target.setValue("open"==this.dataset.value?!1:!0)});d.on_change_callback=b;d.setValue=function(a){this.dataset.value!=(a?"open":"closed")&&(a?(this.dataset.value="open",this.innerHTML="-",this.className="listbox listopen"):(this.dataset.value="closed",this.innerHTML="+",this.className="listbox listclosed"),b&&b(this.dataset.value))};return d};LiteGUI.List=
function(a,b,d){d=d||{};var c=document.createElement("ul");this.root=c;c.id=a;c.className="litelist";this.items=[];var f=this;this.callback=d.callback;for(var g in b){a=document.createElement("li");a.className="list-item";a.data=b[g];var h="";"string"==typeof b[g]?h=b[g]+"<span class='arrow'></span>":(h=(b[g].name||b[g].title||"")+"<span class='arrow'></span>",b[g].id&&(a.id=b[g].id));a.innerHTML=h;c.appendChild(a)}$(c).find(".list-item").click(function(){$(c).find(".list-item.selected").removeClass("selected");
$(this).addClass("selected");$(f).trigger("wchanged",this);f.callback&&f.callback(this.data)});d.parent&&(d.parent.root?$(d.parent.root).append(c):$(d.parent).append(c))};LiteGUI.LineEditor=function(a,b){function c(a){return[n.width*((k.xrange[1]-k.xrange[0])*a[0]+k.xrange[0]),n.height*((k.yrange[1]-k.yrange[0])*a[1]+k.yrange[0])]}function e(a){return[(a[0]/n.width-k.xrange[0])/(k.xrange[1]-k.xrange[0]),(a[1]/n.height-k.yrange[0])/(k.yrange[1]-k.yrange[0])]}function f(a){var b=n.getBoundingClientRect(),
c=a.clientX-b.left,d=a.clientY-b.top;0>c?c=0:c>n.width&&(c=n.width);0>d?d=0:d>n.height&&(d=n.height);if(-1!=p&&l([a.clientX-b.left,a.clientY-b.top],[c,d])>0.5*n.height)k.value.splice(p,1),g(a);else{b=e([-(r[0]-c),r[1]-d]);if(-1!=p){var f=k.xrange[0],s=k.xrange[1];k.no_trespassing&&(0<p&&(f=k.value[p-1][0]),p<k.value.length-1&&(s=k.value[p+1][0]));var q=k.value[p];q[0]+=b[0];q[1]+=b[1];q[0]<f?q[0]=f:q[0]>s&&(q[0]=s);q[1]<k.yrange[0]?q[1]=k.yrange[0]:q[1]>k.yrange[1]&&(q[1]=k.yrange[1])}m();k.redraw();
r[0]=c;r[1]=d;h();a.preventDefault();a.stopPropagation()}}function g(a){p=-1;k.redraw();$(document).unbind("mousemove",f);$(document).unbind("mouseup",g);h();a.preventDefault();a.stopPropagation()}function h(){b.callback?b.callback.call(k,k.value):$(k).change()}function l(a,b){return Math.sqrt(Math.pow(b[0]-a[0],2)+Math.pow(b[1]-a[1],2))}function m(){var a=null;-1!=p&&(a=k.value[p]);k.value.sort(function(a,b){return a[0]>b[0]});a&&(p=k.value.indexOf(a))}b=b||{};var k=document.createElement("div");
k.className="curve "+(b.extraclass?b.extraclass:"");k.style.minHeight="50px";k.style.width=b.width||"100%";k.bgcolor=b.bgcolor||"#222";k.pointscolor=b.pointscolor||"#5AF";k.linecolor=b.linecolor||"#444";k.value=a||[];k.xrange=b.xrange||[0,1];k.yrange=b.yrange||[0,1];k.defaulty=null!=b.defaulty?b.defaulty:0.5;k.no_trespassing=b.no_trespassing||!1;k.show_samples=b.show_samples||0;k.options=b;var n=document.createElement("canvas");n.width=b.width||200;n.height=b.height||50;k.appendChild(n);k.canvas=
n;$(n).bind("mousedown",function(a){$(document).bind("mousemove",f);$(document).bind("mouseup",g);for(var b=n.getBoundingClientRect(),h=a.clientX-b.left,b=a.clientY-b.top,u=n.height-b,v=1E5,s=-1,q=0;q<k.value.length;q++){var t=c(k.value[q]),t=l([h,u],t);t<v&&8>t&&(v=t,s=q)}p=s;-1==p&&(u=e([h,n.height-b]),k.value.push(u),m(),p=k.value.indexOf(u));r=[h,b];k.redraw();a.preventDefault();a.stopPropagation()});$(k).resize(function(a){n.width=$(this).width();n.height=$(this).height();k.redraw()});k.getValueAt=
function(a){if(a<k.xrange[0]||a>k.xrange[1])return k.defaulty;for(var b=[k.xrange[0],k.defaulty],c=0,c=0;c<k.value.length;c+=1){var d=k.value[c];if(a==d[0])return d[1];if(a<d[0])return c=(a-b[0])/(d[0]-b[0]),b[1]*(1-c)+d[1]*c;b=d}d=[k.xrange[1],k.defaulty];c=(a-b[0])/(d[0]-b[0]);return b[1]*(1-c)+d[1]*c};k.resample=function(a){var b=[];a=(k.xrange[1]-k.xrange[0])/a;for(var c=k.xrange[0];c<=k.xrange[1];c+=a)b.push(k.getValueAt(c));return b};k.addValue=function(a){for(var b=0;b<k.value;b++)if(!(k.value[b][0]<
a[0])){k.value.splice(b,0,a);redraw();return}k.value.push(a);redraw()};var p=-1;k.redraw=function(){var a=n.getContext("2d");a.setTransform(1,0,0,1,0,0);a.translate(0,n.height);a.scale(1,-1);a.fillStyle=k.bgcolor;a.fillRect(0,0,n.width,n.height);a.strokeStyle=k.linecolor;a.beginPath();var b=c([k.xrange[0],k.defaulty]);a.moveTo(b[0],b[1]);for(var e in k.value)b=k.value[e],b=c(b),a.lineTo(b[0],b[1]);b=c([k.xrange[1],k.defaulty]);a.lineTo(b[0],b[1]);a.stroke();for(e=0;e<k.value.length;e+=1)b=k.value[e],
b=c(b),a.fillStyle=p==e?"white":k.pointscolor,a.beginPath(),a.arc(b[0],b[1],p==e?4:2,0,2*Math.PI),a.fill();if(k.show_samples){var f=k.resample(k.show_samples);a.fillStyle="#888";for(e=0;e<f.length;e+=1)b=[e*((k.xrange[1]-k.xrange[0])/k.show_samples)+k.xrange[0],f[e]],b=c(b),a.beginPath(),a.arc(b[0],b[1],2,0,2*Math.PI),a.fill()}};var r=[0,0];k.redraw();return k}})();
(function(){function c(a){this.menu=[];this.panels=[];this.root=document.createElement("div");this.root.id=a;this.root.className="litemenubar";this.content=document.createElement("ul");this.root.appendChild(this.content);this.is_open=!1}c.closing_time=500;c.prototype.clear=function(){$(this.content).empty();this.menu=[];this.panels=[]};c.prototype.attachToPanel=function(a){$(a.content).prepend(this.root)};c.prototype.add=function(a,b){b=b||{};for(var c=this.menu.length,e=a.split("/"),f=0,g=0,h=this.menu;h;)if(h.length==
g){g={children:[]};f==e.length-1&&(g.data=b);g.disable=function(){this.data&&(this.data.disabled=!0)};g.enable=function(){this.data&&delete this.data.disabled};g.name=e[f];h.push(g);f++;if(f==e.length)break;g.children=[];h=g.children;g=0}else{if(h[g]&&e[f]==h[g].name)if(f<e.length){h=h[g].children;g=0;f++;continue}else{trace("Warning: Adding menu that already exists: "+a);break}g++}c!=this.menu.length&&this.updateMenu()};c.prototype.separator=function(a,b){var c=this.findMenu(a);c&&c.push({separator:!0,
order:b||10})};c.prototype.findMenu=function(a){a=a.split("/");for(var b=0,c=0,e=this.menu;e;){if(b==a.length)return e;if(e.length<=c)break;if("*"==a[b])return e[c].children;if(a[b]==e[c].name)if(b<a.length){e=e[c].children;c=0;b++;continue}else return e[c];c++}return null};c.prototype.updateMenu=function(){var a=this;$(this.content).empty();for(var b in this.menu){var c=document.createElement("li");c.innerHTML="<span class='icon'></span><span class='name'>"+this.menu[b].name+"</span>";this.content.appendChild(c);
c.data=this.menu[b];this.menu[b].element=c;$(c).bind("click",function(b){var c=this.data;c.data&&c.data.callback&&"function"==typeof c.data.callback&&c.data.callback(c.data);a.is_open?(a.is_open=!1,a.hidePanels()):(a.is_open=!0,a.showMenu(c,b,this))});$(c).bind("mouseover",function(b){a.hidePanels();a.is_open&&a.showMenu(this.data,b,this)})}};c.prototype.hidePanels=function(){if(this.panels.length){for(var a in this.panels)$(this.panels[a]).remove();this.panels=[]}};c.prototype.showMenu=function(a,
b,c,e){e||this.hidePanels();if(a.children&&a.children.length){var f=this;f.closing_by_leave&&clearInterval(f.closing_by_leave);var g=document.createElement("div");g.className="litemenubar-panel";var h=[],l;for(l in a.children)h.push(a.children[l]);h.sort(function(a,b){var c=10,d=10;a&&a.data&&null!=a.data.order&&(c=a.data.order);a&&a.separator&&null!=a.order&&(c=a.order);b&&b.data&&null!=b.data.order&&(d=b.data.order);b&&b.separator&&null!=b.order&&(d=b.order);return c-d});for(l in h){a=document.createElement("p");
var m=h[l];a.className="litemenu-entry "+(a.children?" submenu":"");a.innerHTML=m&&m.name?"<span class='icon'></span><span class='name'>"+m.name+(m.children&&m.children.length?"<span class='more'>+</span>":"")+"</span>":"<span class='separator'></span>";a.data=m;if(a.data.data){m=a.data.data;if("checkbox"==m.type&&m.instance&&m.property&&!0==m.instance[m.property]||!0==m.checkbox||m.instance&&m.property&&m.hasOwnProperty("value")&&m.instance[m.property]==m.value||"function"==typeof m.isChecked&&m.isChecked.call(m.instance,
m))a.className+=" checked";m.disabled&&(a.className+=" disabled")}$(a).bind("click",function(){var a=this.data;if(a.data){if(a.data.disabled)return;a.data.instance&&a.data.property&&("checkbox"==a.data.type?(a.data.instance[a.data.property]=!a.data.instance[a.data.property],a.data.instance[a.data.property]?$(this).addClass("checked"):$(this).removeClass("checked")):a.data.hasOwnProperty("value")&&(a.data.instance[a.data.property]=a.data.value));null!=a.data.checkbox&&(a.data.checkbox=!a.data.checkbox,
a.data.checkbox?$(this).addClass("checked"):$(this).removeClass("checked"));a.data.callback&&"function"==typeof a.data.callback&&a.data.callback(a.data)}a.children&&a.children.length?f.showMenu(a,b,this,!0):(f.is_open=!1,f.hidePanels())});$(g).append(a)}$(g).bind("mouseleave",function(a){f.closing_by_leave&&clearInterval(f.closing_by_leave);f.closing_by_leave=setTimeout(function(){f.is_open=!1;f.hidePanels()},LiteGUI.Menubar.closing_time)});$(g).bind("mouseenter",function(a){f.closing_by_leave&&clearInterval(f.closing_by_leave);
f.closing_by_leave=null});c=$(c);g.style.left=c.offset().left+(e?200:0)+"px";g.style.top=c.offset().top+c.height()+(e?-20:2)+"px";this.panels.push(g);$(document.body).append(g);$(g).hide().show()}};LiteGUI.Menubar=c})();
(function(){function c(a,b){b=b||{};var c=document.createElement("DIV");a&&(c.id=a);c.data=this;c.className="litetabs";this.root=c;this.current_tab=null;b.height&&(this.root.style.height="full"==b.height?"100%":b.height);c=document.createElement("UL");c.className="wtabcontainer";this.list=c;this.root.appendChild(this.list);this.contents={};this.selected=null;this.onchange=b.callback;b.parent&&this.appendTo(b.parent)}c.tabs_height="30px";c.prototype.getCurrentTab=function(){return this.current_tab};
c.prototype.appendTo=function(a,b){b?$(a).prepend(this.root):$(a).append(this.root)};c.prototype.get=function(a){return this.contents[a]};c.prototype.add=function(a,b){b=b||{};var c=this,e=document.createElement("LI");e.className="wtab wtab-"+a.replace(/ /gi,"_");e.data=a;e.innerHTML=a;$(this.list).append(e);var f=document.createElement("div");b.id&&(f.id=b.id);f.className="wtabcontent wtabcontent-"+a+" "+(b.className||"");f.data=a;f.style.display="none";b.height&&(f.style.overflow="auto","full"==
b.height?(f.style.height="calc( 100% - "+LiteGUI.Tabs.tabs_height+" )",f.style.height="-moz-calc( 100% - "+LiteGUI.Tabs.tabs_height+" )",f.style.height="-webkit-calc( 100% - "+LiteGUI.Tabs.tabs_height+" )"):f.style.height=b.height);b.content&&("string"==typeof b.content?f.innerHTML=b.content:f.appendChild(b.content));$(this.root).append(f);this.contents[a]=f;$(e).click(function(e){if(!$(this).hasClass("selected")){e=this.data;var f=null,l;for(l in c.contents)l==e?($(c.contents[l]).show(),f=c.contents[l]):
$(c.contents[l]).hide();$(c.list).find("li.wtab").removeClass("selected");$(this).addClass("selected");c.current_tab&&c.current_tab[0]!=e&&c.current_tab[2]&&c.current_tab[2].callback_leave&&c.current_tab[2].callback_leave(c.current_tab[0],c.current_tab[1],c.current_tab[2]);c.current_tab=[e,f,b];b.callback&&b.callback(e,f);$(c).trigger("wchange",[e,f]);if(c.onchange)c.onchange(a,e,f);c.selected=a}});this.list.appendChild(e);!0!=b.selected&&null!=this.selected||this.select(a);return{tab:e,content:f}};
c.prototype.select=function(a){for(var b=$(this.list).find("li.wtab"),c=0;c<b.length;c++)if(a==b[c].data){$(b[c]).click();break}};LiteGUI.Tabs=c})();
(function(){LiteGUI.Dragger=function(c,a){function b(b){var c=[b.screenX-m.data[0],m.data[1]-b.screenY];m.data=[b.screenX,b.screenY];e(c[a.horizontal?0:1],b);b.stopPropagation();b.preventDefault();return!1}function d(a){$(m).trigger("stop_dragging");$(document).unbind("mousemove",b);$(document).unbind("mouseup",d);$(m).trigger("blur");a.stopPropagation();a.preventDefault();return!1}function e(b,c){var d=a.step?a.step:1;c&&c.shiftKey?d*=10:c&&c.ctrlKey&&(d*=0.1);d=parseFloat(l.value)+b*d;null!=a.max&&
d>a.max&&(d=a.max);null!=a.min&&d<a.min&&(d=a.min);l.value=a.precision?d.toFixed(a.precision):(1E3*d<<0)/1E3;a.units&&(l.value+=a.units);$(l).change()}a=a||{};var f=document.createElement("div");f.className="dragger "+(a.extraclass?a.extraclass:"");var g=document.createElement("span");g.className="inputfield "+(a.extraclass?a.extraclass:"");a.disabled&&(g.className+=" disabled");f.appendChild(g);var h=a.dragger_class||"full",l=document.createElement("input");l.className="text number "+(h?h:"");l.value=
c+(a.units?a.units:"");l.tabIndex=a.tab_index;this.input=l;this.setValue=function(a){$(l).val(a).trigger("change")};$(l).bind("keydown",function(a){if(38==a.keyCode)e(1,a);else if(40==a.keyCode)e(-1,a);else return;a.stopPropagation();a.preventDefault();return!0});a.disabled&&(l.disabled=!0);a.tab_index&&(l.tabIndex=a.tab_index);g.appendChild(l);f.input=l;var m=document.createElement("div");m.className="drag_widget";a.disabled&&(m.className+=" disabled");g.appendChild(m);f.dragger=m;this.root=f;$(m).bind("mousedown",
function(c){a.disabled||($(document).bind("mousemove",b),$(document).bind("mouseup",d),m.data=[c.screenX,c.screenY],$(m).trigger("start_dragging"));c.stopPropagation();c.preventDefault()})}})();
(function(){function c(a,b,c){var e=document.createElement("div");this.root=e;e.id=a;e.className="litetree";this.tree=b;this.options=c=c||{allow_rename:!0,drag:!0};a=this.createTreeItem(b,c);a.className+=" root_item";this.root.appendChild(a);this.root_item=a}c.prototype.updateTree=function(a){this.root_item&&$(this.root_item).remove();a&&(a=this.createTreeItem(a,this.options),a.className+=" root_item",this.root.appendChild(a),this.root_item=a)};c.prototype.createTreeItem=function(a,b){var c=document.createElement("li");
c.className="ltreeitem";a.id&&(c.id=a.id);c.data=a;a.DOM=c;b=b||this.options;var e=document.createElement("div");e.className="ltreeitemtitle";e.innerHTML="<span class='precontent'></span><span class='incontent'>"+(a.content||a.id||"")+"</span><span class='postcontent'></span>";c.appendChild(e);c.title_element=e;var f=$(c).find(".ltreeitemtitle .incontent");f.click(function(a){a=this.parentNode;var b=a.parentNode;a._editing||($(l.root).removeClass("selected"),$(l.root).find(".ltreeitemtitle.selected").removeClass("selected"),
$(a).addClass("selected"),$(l).trigger("item_selected",[b.data,b]),b.callback&&b.callback.call(l,b))});f.dblclick(function(a){var b=this.parentNode;$(l).trigger("item_dblclicked",[b.data,b]);if(!this._editing&&l.options.allow_rename){this._editing=!0;this._old_name=this.innerHTML;var c=this;this.innerHTML="<input type='text' value='"+this.innerHTML+"' />";var d=$(this).find("input")[0];$(d).blur(function(a){a=a.target.value;c.innerHTML=a;delete c._editing;$(l).trigger("item_renamed",[c._old_name,
a,b]);delete c._old_name});$(d).bind("keydown",function(a){13==a.keyCode&&$(this).blur()});$(d).focus();a.preventDefault()}});f[0].addEventListener("contextmenu",function(a){if(l.onContextMenu&&2==a.button&&l.onContextMenu)l.onContextMenu(a);a.preventDefault();return!1});f=document.createElement("ul");f.className="ltreeitemchildren";c.children_element=f;c.list=f;if(a.children)for(var g in a.children){var h=this.createTreeItem(a.children[g],b);f.appendChild(h)}c.appendChild(f);this.updateListBox(c);
var l=this;e.draggable=!0;e.addEventListener("dragstart",function(a){a.dataTransfer.setData("node-id",this.parentNode.id)});e.addEventListener("dragenter",function(a){$(e).addClass("dragover");a.preventDefault()});e.addEventListener("dragleave",function(a){$(e).removeClass("dragover");a.preventDefault()});e.addEventListener("dragover",function(a){a.preventDefault()});e.addEventListener("drop",function(a){$(e).removeClass("dragover");a.preventDefault();var b=a.dataTransfer.getData("node-id");if(""!=
b)try{l.moveItem(b,this.parentNode.id)&&$(l).trigger("item_moved",[l.getItem(b),l.getItem(this.parentNode.id)])}catch(c){trace("Error: "+c)}else $(l).trigger("drop_on_item",[this,a])});return c};c.onClickBox=function(a){a=this.children_element;a.style.display="none"==a.style.display?"block":"none"};c.prototype.getItem=function(a){a=this.root.querySelector("#"+a);if(!a)return null;if(!$(a).hasClass("ltreeitem"))throw"this node is not a tree item";return a};c.prototype.expandItem=function(a){(a=this.getItem(a))&&
a.listbox&&listbox.setValue(!0)};c.prototype.contractItem=function(a){(a=this.getItem(a))&&a.listbox&&listbox.setValue(!1)};c.prototype.setSelectedItem=function(a){if(a){a=this.getItem(a);if(!a)return null;if($(a).hasClass("selected"))return a;$(this.root).removeClass("selected");$(this.root).find(".ltreeitemtitle.selected").removeClass("selected");$(a.title_element).addClass("selected");return a}$(this.root).removeClass("selected");$(this.root).find(".ltreeitemtitle.selected").removeClass("selected")};
c.prototype.getSelectedItem=function(){return this.root.querySelector(".ltreeitemtitle.selected")};c.prototype.insertItem=function(a,b,c,e){var f=this.root_item;if(b&&(f="string"==typeof b?this.getItem(b):b,!f))return null;if(!$(f).hasClass("ltreeitem"))throw"this node is not a tree item";a=this.createTreeItem(a,e);void 0==c?f.list.appendChild(a):f.list.insertBefore(a,f.list.childNodes[c]);this.updateListBox(f);return a};c.prototype.updateListBox=function(a){var b=this.getChildren(a);if(b)if(b.length&&
!a.listbox){var b=a.title_element.querySelector(".precontent"),d=LiteGUI.createLitebox(!0,c.onClickBox.bind(a));b.appendChild(d);a.listbox=d}else!b.length&&a.listbox&&(a.listbox.parentNode.removeChild(a.listbox),a.listbox=null)};c.prototype.getChildren=function(a){"string"==typeof a&&this.getItem(a);if(!a||!a.list)return null;a=a.list.childNodes;var b=[],c;for(c in a){var e=a[c];"li"==e.localName&&$(e).hasClass("ltreeitem")&&b.push(e)}return b};c.prototype.getParent=function(a){"string"==typeof a&&
this.getItem(a);if(!a)return null;for(a=a.parentNode;a;){if($(a).hasClass("ltreeitem"))return a;a=a.parentNode}return null};c.prototype.moveItem=function(a,b){var c=this.getItem(b),e=this.getItem(a),f=this.getParent(e);if(!c||!e)return!1;if(c!=f)return c.list.appendChild(e),this.updateListBox(c),f&&this.updateListBox(f),!0};c.prototype.removeItem=function(a){var b=a;"string"==typeof a&&(b=this.getItem(a));if(!b)return null;(a=this.getParent(b))&&a.list&&(a.list.removeChild(b),a&&this.updateListBox(a))};
c.prototype.updateItem=function(a,b){var c=this.getItem(a);c&&(c.data=b,b.id&&(c.id=b.id),b.content&&(c.title_element.innerHTML="<span class='precontent'></span><span class='incontent'>"+b.content+"</span><span class='postcontent'></span>"))};c.prototype.clear=function(a){$(a?this.root_item:this.root).find(".ltreeitem").remove()};LiteGUI.Tree=c})();
(function(){function c(a,b){b=b||{};this.width=b.width||200;this.height=b.height||100;this.content=b.content||"";var c=document.createElement("div");c.id=a;c.className="litepanel "+(b.className||"");c.data=this;var e="";b.title&&(e+="<div class='panel-header'>"+b.title+"</div><div class='buttons'>",b.minimize&&(e+="<button class='mini-button minimize-button'></button><button class='mini-button maximize-button' style='display:none'></button>"),b.hide&&(e+="<button class='mini-button hide-button'></button>"),
b.close&&(e+="<button class='mini-button close-button'></button>"),e+="</div>");e+="<div class='content'>"+this.content+"</div>";e+="<div class='panel-footer'></div>";c.innerHTML=e;this.root=c;this.content=$(c).find(".content")[0];this.footer=$(c).find(".panel-footer")[0];if(b.buttons)for(var f in b.buttons)this.addButton(b.buttons[f].name,b.buttons[f]);!0==b.scroll&&(this.content.style.overflow="auto");$(c).find(".close-button").bind("click",this.close.bind(this));$(c).find(".minimize-button").bind("click",
this.minimize.bind(this));$(c).find(".maximize-button").bind("click",this.maximize.bind(this));$(c).find(".hide-button").bind("click",this.hide.bind(this));this.makeDialog(b)}c.MINIMIZED_WIDTH=200;c.title_height="20px";c.prototype.makeDialog=function(a){a=a||{};var b=this.root;b.style.position="absolute";b.style.display="none";b.style.width=this.width+"px";this.height&&(b.style.height=this.height+"px");this.height&&$(b).find(".content").css({height:this.height-24});b.style.boxShadow="0 0 3px black";
a.draggable&&(this.draggable=!0,$(b).draggable({handle:".panel-header"}));a.resizable&&this.setResizable();$(a.parent||LiteGUI.root_container).append(this.root);this.center()};c.prototype.setResizable=function(){function a(c){if("mousedown"==c.type)document.body.addEventListener("mousemove",a),document.body.addEventListener("mouseup",a),e[0]=c.pageX,e[1]=c.pageY;else if("mousemove"==c.type){var d=$(b).height()-(e[1]-c.pageY);$(b).height(d+"px");e[0]=c.pageX;e[1]=c.pageY;f.content.style.height="calc( 100% - 24px )"}else"mouseup"==
c.type&&(document.body.removeEventListener("mousemove",a),document.body.removeEventListener("mouseup",a));c.preventDefault();return!1}if(!this.resizable){var b=this.root;this.resizable=!0;var c=this.footer;c.style.minHeight="4px";$(c).addClass("resizable");c.addEventListener("mousedown",a);var e=[0,0],f=this}};c.prototype.dockTo=function(a,b){if(a){var c=this.root;c.style.top=0;c.style.left=0;c.style.boxShadow="0 0 0";if("full"==b)c.style.position="relative",c.style.width="100%",c.style.height="100%",
this.content.style.width="100%",this.content.style.height="calc(100% - "+LiteGUI.Panel.title_height+")",this.content.style.height="-moz-calc(100% - "+LiteGUI.Panel.title_height+")",this.content.style.height="-webkit-calc(100% - "+LiteGUI.Panel.title_height+")",this.content.style.overflow="auto";else if("left"==b||"right"==b)c.style.position="absolute",c.style.top=0,c.style[b]=0,c.style.width=this.width+"px",c.style.height="100%",this.content.style.height="-moz-calc(100% - "+LiteGUI.Panel.title_height+
")",this.content.style.height="-webkit-calc(100% - "+LiteGUI.Panel.title_height+")",this.content.style.height="calc(100% - "+LiteGUI.Panel.title_height+")",this.content.style.overflow="auto","right"==b&&(c.style.left="auto",c.style.right=0);else if("bottom"==b||"top"==b)c.style.width="100%",c.style.height=this.height+"px","bottom"==b&&(c.style.bottom=0,c.style.top="auto");this.draggable&&$(c).draggable({disabled:!0});a.content?a.content.appendChild(c):"string"==typeof a?$(a).append(c):a.appendChild(c)}};
c.prototype.addButton=function(a,b){var c=this,e=document.createElement("button");e.innerHTML=a;b.className&&(e.className=b.className);$(this.root).find(".panel-footer").append(e);$(e).bind("click",function(){b.callback&&b.callback();b.close&&c.close()});return e};c.prototype.close=function(a){$(this).trigger("closed");a?$(this.root).hide("fade",null,function(){$(this.root).remove()}):$(this.root).remove()};c.minimized=[];c.prototype.minimize=function(){this.minimized||(this.minimized=!0,this.old_pos=
$(this.root).position(),$(this.root).find(".content").hide(),$(this.root).draggable({disabled:!0}),$(this.root).find(".minimize-button").hide(),$(this.root).find(".maximize-button").show(),$(this.root).css({width:LiteGUI.Panel.MINIMIZED_WIDTH}),$(this).bind("closed",function(){LiteGUI.Panel.minimized.splice(LiteGUI.Panel.minimized.indexOf(this),1);LiteGUI.Panel.arrangeMinimized()}),LiteGUI.Panel.minimized.push(this),LiteGUI.Panel.arrangeMinimized(),$(this).trigger("minimizing"))};c.arrangeMinimized=
function(){for(var a in LiteGUI.Panel.minimized){var b=LiteGUI.Panel.minimized[a],c=$(b.root.parentNode).height()-20;$(b.root).animate({left:LiteGUI.Panel.MINIMIZED_WIDTH*a,top:c+"px"},100)}};c.prototype.maximize=function(){this.minimized&&(this.minimized=!1,$(this.root).find(".content").show(),$(this.root).draggable({disabled:!1}),$(this.root).animate({left:this.old_pos.left+"px",top:this.old_pos.top+"px",width:this.width},100),$(this.root).find(".minimize-button").show(),$(this.root).find(".maximize-button").hide(),
LiteGUI.Panel.minimized.splice(LiteGUI.Panel.minimized.indexOf(this),1),LiteGUI.Panel.arrangeMinimized(),$(this).trigger("maximizing"))};c.prototype.makeModal=function(){LiteGUI.showModalBackground(!0);$(LiteGUI.modalbg_div).append(this.root);$(this.root).draggable({disabled:!0});this.show();this.center();$(this).bind("closed",function(a){trace("closing");LiteGUI.showModalBackground(!1)})};c.prototype.bringToFront=function(){var a=$(this.root).parent();a.detach(this.root);a.attach(this.root)};c.prototype.show=
function(a,b){$(this.root).show(a,null,100,b);$(this).trigger("shown")};c.prototype.hide=function(a,b){$(this.root).hide(a,null,100,b);$(this).trigger("hidden")};c.prototype.setPosition=function(a,b){this.root.position="absolute";this.root.style.left=a+"px";this.root.style.top=b+"px"};c.prototype.center=function(){this.root.position="absolute";this.root.style.left=Math.floor(0.5*($(this.root.parentNode).width()-$(this.root).width()))+"px";this.root.style.top=Math.floor(0.5*($(this.root.parentNode).height()-
$(this.root).height()))+"px"};LiteGUI.Panel=c;LiteGUI.Dialog=c})();jQuery.fn.wchange=function(c){$(this[0]).bind("wchange",c)};jQuery.fn.wclick=function(c){$(this[0]).bind("wclick",c)};
function Inspector(c,a){a=a||{};this.root=document.createElement("DIV");this.root.className="inspector "+(a.full?"full":"");a.one_line&&(this.root.className+=" one-line");c&&(this.root.id=c);this.values={};this.sections=[];this.widgets={};this.addSection();this.tab_index=Math.floor(1E4*Math.random());a.name_width&&(this.widget_name_width=a.name_width);a.parent&&this.appendTo(a.parent);this.widgets_per_row=a.widgets_per_row||1}Inspector.prototype.appendTo=function(c,a){a?$(c).prepend(this.root):$(c).append(this.root)};
Inspector.prototype.clear=function(){$(this.root).empty();this.sections=[];this.values={};this.widgets={};this.addSection()};Inspector.prototype.append=function(c){var a=this.root;this.current_group_content?a=this.current_group_content:this.current_section_content&&(a=this.current_section_content);a.appendChild(c)};Inspector.prototype.setup=function(c){for(var a in c){var b=c[a];this.add(b.type,b.name,b.value,b.options)}};
Inspector.prototype.inspectInstance=function(c,a,b){if(c){a=!a&&c.getAttributes?c.getAttributes():this.collectAttributes(c);var d=c.constructor;!b&&d.attributes&&(b=d.attributes);b||(b={});for(var e in a)if(!b[e]){var f=a[e];if(d["@"+e]){var f={},g=d["@"+e],h;for(h in g)f[h]=g[h];b[e]=f}else if(c["@"+e])b[e]=c["@"+e];else if("number"==typeof f)b[e]={type:"number"};else if("string"==typeof f)b[e]={type:"string"};else if("boolean"==typeof f)b[e]={type:"boolean"};else if(f&&f.length)switch(f.length){case 2:b[e]=
{type:"vec2"};break;case 3:b[e]={type:"vec3"};break;case 4:b[e]={type:"vec4"}}}return this.showAttributes(c,b)}};Inspector.prototype.collectAttributes=function(c){var a={},b;for(b in c)if("_"!=b[0]&&"@"!=b[0]&&"jQuery"!=b.substr(0,6)){var d=c[b];d&&d.constructor==Function||(a[b]=d)}return a};
Inspector.prototype.showAttributes=function(c,a){for(var b in a){var d=a[b];d.callback||(d.callback=Inspector.assignValue.bind({instance:c,name:b,options:d}));d.instance=c;this.add(d.type||d.widget||"string",b,c[b],d)}};
Inspector.assignValue=function(c){var a=this.instance,b=a[this.name];if(null==b||null==c)a[this.name]=c;else if("number"==typeof b)a[this.name]=parseFloat(c);else if("string"==typeof b)a[this.name]=c;else if(c&&c.length&&b&&b.length)for(a=0;a<b.length;++a)b[a]=c[a];else a[this.name]=c};
Inspector.prototype.createWidget=function(c,a,b){b=b||{};a=a||"";var d=document.createElement("DIV");d.className="widget "+(b.className||"");d.inspector=this;d.options=b;d.name=c;b.width&&(d.style.width="string"==typeof b.width?b.width:b.width+"px",d.style.minWidth=d.style.width);c&&(this.widgets[c]=d);1!=this.widgets_per_row&&(b.width||(d.style.width=(100/this.widgets_per_row).toFixed(2)+"%"),d.style.display="inline-block");var e="",f="";if(this.widget_name_width||b.widget_name_width)f=this.widget_name_width||
b.widget_name_width,"number"==typeof f&&(f=f.toFixed()+"px"),e="style='width: calc("+f+" - 0px); width: -webkit-calc("+f+" - 0px); width: -moz-calc("+f+" - 0px); '",f="style='width: calc( 100% - "+f+"); width: -webkit-calc(100% - "+f+"); width: -moz-calc( 100% - "+f+"); '";b="";var g="wcontent ";null==c?g+=" full":b=""==c?"<span class='wname' title='"+c+"' "+e+"></span>":"<span class='wname' title='"+c+"' "+e+">"+c+"<span class='filling'>....................</span> </span>";"string"==typeof a?d.innerHTML=
b+"<span class='info_content "+g+"' "+f+">"+a+"</span>":(d.innerHTML=b+"<span class='info_content "+g+"' "+f+"></span>",$(d).find("span.info_content").append(a));return d};Inspector.onWidgetChange=function(c,a,b,d){this.values[a]=b;$(this.current_section).trigger("wchange",b);d.callback&&d.callback.call(c,b);$(c).trigger("wchange",b);if(this.onchange)this.onchange(a,b,c)};
Inspector.widget_constructors={title:"addTitle",info:"addInfo",number:"addNumber",slider:"addSlider",string:"addString",text:"addString",textarea:"addTextarea",color:"addColor","boolean":"addCheckbox",checkbox:"addCheckbox",vec2:"addVector2",vector2:"addVector2",vec3:"addVector3",vector3:"addVector3","enum":"addCombo",combo:"addCombo",button:"addButton",buttons:"addButtons",file:"addFile",line:"addLine",list:"addList",separator:"addSeparator"};
Inspector.prototype.add=function(c,a,b,d){"object"==typeof c&&1==arguments.length&&(d=c,c=d.type,a=d.name,b=d.value);var e=Inspector.widget_constructors[c];if(e&&("string"==typeof e&&(e=Inspector.prototype[e]),e&&"function"==typeof e))return"function"==typeof d&&(d={callback:d}),e.call(this,a,b,d)};Inspector.prototype.getValue=function(c){return this.values[c]};Inspector.prototype.set=function(c,a){};
Inspector.prototype.addSection=function(c,a){a=a||{};this.current_group&&this.endGroup();var b=document.createElement("DIV");b.className="wsection";c||(b.className+=" notitle");var d="";c&&(d+="<div class='wsectiontitle'>"+(a.no_minimize?"":"<span class='switch-section-button'></span>")+c+"</div>");b.innerHTML=d+"<div class='wsectioncontent'></div>";this.root.appendChild(b);c&&$(b).find(".wsectiontitle").click(function(a){"button"!=a.target.localName&&($(b).toggleClass("minimized"),$(b).find(".wsectioncontent").toggle())});
this.current_section=b;this.content=this.current_section_content=$(b).find(".wsectioncontent")[0];a.widgets_per_row&&(this.widgets_per_row=a.widgets_per_row);return b};
Inspector.prototype.beginGroup=function(c,a){a=a||{};this.current_group&&this.endGroup();var b=document.createElement("DIV");b.className="wgroup";b.innerHTML="<div class='wgroupheader "+(a.title?"wtitle":"")+"'><span class='wgrouptoggle'>-</span>"+c+"</div>";var d=document.createElement("DIV");d.className="wgroupcontent";a.collapsed&&(d.style.display="none");b.appendChild(d);var e=a.collapsed||!1;$(b).find(".wgroupheader").click(function(){$(b).find(".wgroupcontent").toggle();e=!e;$(b).find(".wgrouptoggle").html(e?
"+":"-")});this.append(b);this.current_group=b;this.content=this.current_group_content=d;return b};Inspector.prototype.endGroup=function(c){this.current_group_content=this.current_group=null;this.content=this.current_section_content};
Inspector.prototype.addTitle=function(c,a){a=a||{};var b=document.createElement("DIV"),d="<span class='wtitle'><span class='text'>"+c+"</span>";a.help&&(d+="<span class='help'><div class='help-content'>"+a.help+"</div></span>");b.innerHTML=d+"</span>";b.setValue=function(a){$(this).find(".text").html(a)};this.append(b);return b};Inspector.prototype.addSeparator=function(){var c=document.createElement("DIV");c.className="separator";this.append(c);return c};
Inspector.prototype.addString=function(c,a,b){b=b||{};a=a||"";var d=this;this.values[c]=a;var e="text";b.password&&(e="password");var f=this.createWidget(c,"<span class='inputfield full "+(b.disabled?"disabled":"")+"'><input type='"+e+"' tabIndex='"+this.tab_index+"' class='text string' value='"+a+"' "+(b.disabled?"disabled":"")+"/></span>",b);$(f).find(".wcontent input").change(function(a){Inspector.onWidgetChange.call(d,f,c,a.target.value,b)});this.tab_index+=1;f.setValue=function(a){$(this).find("input").val(a).change()};
f.wchange=function(a){$(this).wchange(a)};this.append(f);return f};
Inspector.prototype.addStringButton=function(c,a,b){b=b||{};a=a||"";var d=this;this.values[c]=a;var e=this.createWidget(c,"<span class='inputfield button'><input type='text' tabIndex='"+this.tab_index+"' class='text string' value='"+a+"' "+(b.disabled?"disabled":"")+"/></span><button class='micro'>"+(b.button||"...")+"</button>",b);$(e).find(".wcontent input").change(function(a){Inspector.onWidgetChange.call(d,e,c,a.target.value,b)});$(e).find(".wcontent button").click(function(a){b.callback_button&&
b.callback_button.call(e,$(e).find(".wcontent input").val())});this.tab_index+=1;this.append(e);e.wchange=function(a){$(this).wchange(a)};e.wclick=function(a){$(this).wclick(a)};return e};
Inspector.prototype.addNumber=function(c,a,b){b=b||{step:0.1};a=a||0;var d=this;this.values[c]=a;var e=this.createWidget(c,"",b);this.append(e);b.extraclass="full";b.tab_index=this.tab_index;b.dragger_class="full";this.tab_index++;a=new LiteGUI.Dragger(a,b);$(e).find(".wcontent").append(a.root);$(a).bind("start_dragging",function(a){b.callback_before&&b.callback_before.call(e)});$(e).find("input").change(function(a){d.values[c]=a.target.value;if(b.callback){var g=b.callback.call(e,parseFloat(a.target.value));
"number"==typeof g&&$(this).val(g)}$(e).trigger("wchange",a.target.value);if(d.onchange)d.onchange(c,a.target.value,e)});e.setValue=function(a){$(this).find("input").val(a).change()};return e};
Inspector.prototype.addVector2=function(c,a,b){function d(a){b.callback_before&&b.callback_before()}b=b||{step:0.1};a=a||[0,0];var e=this;this.values[c]=a;var f=this.createWidget(c,"",b);b.step=b.step||0.1;b.dragger_class="medium";b.tab_index=this.tab_index;this.tab_index++;var g=new LiteGUI.Dragger(a[0],b);g.root.style.marginLeft=0;$(f).find(".wcontent").append(g.root);b.tab_index=this.tab_index;this.tab_index++;var h=new LiteGUI.Dragger(a[1],b);$(f).find(".wcontent").append(h.root);$(g).bind("start_dragging",
d);$(h).bind("start_dragging",d);$(f).find("input").change(function(a){a=[];for(var d=$(f).find("input"),g=0;g<d.length;g++)a.push(parseFloat(d[g].value));e.values[c]=a;if(b.callback){var h=b.callback.call(f,a);if("object"==typeof h&&2<=h.length){for(g=0;g<d.length;g++)$(d[g]).val(h[g]);a=h}}$(f).trigger("wchange",[a]);if(e.onchange)e.onchange(c,a,f)});this.append(f);f.setValue=function(a){g.setValue(a[0]);h.setValue(a[1])};return f};
Inspector.prototype.addVector3=function(c,a,b){function d(a){b.callback_before&&b.callback_before()}b=b||{step:0.1};a=a||[0,0,0];var e=this;this.values[c]=a;var f=this.createWidget(c,"",b);b.step=b.step||0.1;b.dragger_class="mini";b.tab_index=this.tab_index;this.tab_index++;var g=new LiteGUI.Dragger(a[0],b);g.root.style.marginLeft=0;$(f).find(".wcontent").append(g.root);b.tab_index=this.tab_index;this.tab_index++;var h=new LiteGUI.Dragger(a[1],b);$(f).find(".wcontent").append(h.root);b.tab_index=
this.tab_index;this.tab_index++;var l=new LiteGUI.Dragger(a[2],b);$(f).find(".wcontent").append(l.root);$(g).bind("start_dragging",d);$(h).bind("start_dragging",d);$(l).bind("start_dragging",d);$(f).find("input").change(function(a){a=[];for(var d=$(f).find("input"),g=0;g<d.length;g++)a.push(parseFloat(d[g].value));e.values[c]=a;if(b.callback){var h=b.callback.call(f,a);if("object"==typeof h&&3<=h.length){for(g=0;g<d.length;g++)$(d[g]).val(h[g]);a=h}}$(f).trigger("wchange",[a]);if(e.onchange)e.onchange(c,
a,f)});this.append(f);f.setValue=function(a){g.setValue(a[0]);h.setValue(a[1]);l.setValue(a[2])};return f};
Inspector.prototype.addTextarea=function(c,a,b){b=b||{};a=a||"";var d=this;this.values[c]=a;var e=this.createWidget(c,"<span class='inputfield textarea "+(b.disabled?"disabled":"")+"'><textarea tabIndex='"+this.tab_index+"' "+(b.disabled?"disabled":"")+">"+a+"</textarea></span>",b);this.tab_index++;$(e).find(".wcontent textarea").bind(b.inmediate?"keyup":"change",function(a){Inspector.onWidgetChange.call(d,e,c,a.target.value,b)});b.height&&$(e).find("textarea").css({height:b.height});this.append(e);
e.setValue=function(a){$(this).find("textarea").val(a).change()};return e};Inspector.prototype.addInfo=function(c,a,b){b=b||{};a=a||"";var d=null;null!=c?d=this.createWidget(c,a,b):(d=document.createElement("div"),d.className=b.className,d.innerHTML="<span class='winfo'>"+a+"</span>");d.setValue=function(a){$(this).find(".winfo").html(a)};b.height&&(c=$(d).find("span.info_content")[0],c.style.height="string"==typeof b.height?b.height:b.height+"px",c.style.overflow="auto");this.append(d);return d};
Inspector.prototype.addSlider=function(c,a,b){b=b||{};b.min=b.min||0;b.max=b.max||1;b.step=b.step||0.01;var d=this;this.values[c]=a;var e=this.createWidget(c,"<span class='inputfield'>\t\t\t\t<input tabIndex='"+this.tab_index+"' type='text' class='slider-text fixed nano' value='"+a+"' /></span>\t\t\t\t<span class='ui-slider'>\t\t\t\t<input class='slider-input' type='range' step='"+b.step+"' min='"+b.min+"' max='"+b.max+"'/><span class='slider-thumb'></span></span>",b);this.tab_index++;var f=$(e).find(".slider-text"),
g=$(e).find(".slider-input"),h=$(e).find(".slider-thumb");g.bind("input",function(a){a=parseFloat(a.target.value);var g=(a-b.min)/(b.max-b.min);l||(f.val(a),Inspector.onWidgetChange.call(d,e,c,a,b));h.css({left:(90*g).toFixed(2)+"%"})});var l=!1;f.bind("change",function(){if(!l){var a=parseFloat($(this).val());a>b.max?(l=!0,g.val(b.max),l=!1):g.val(a);var f=(a-b.min)/(b.max-b.min);1<f?f=1:0>f&&(f=0);h.css({left:f*($(g).width()-12)});Inspector.onWidgetChange.call(d,e,c,a,b)}});this.append(e);e.setValue=
function(a){f.val(a)};l=!0;g.val(a).trigger("input");l=!1;return e};
Inspector.prototype.addCheckbox=function(c,a,b){b=b||{};a=a||"";var d=this;this.values[c]=a;var e=this.createWidget(c,"<span class='inputfield'><span tabIndex='"+this.tab_index+"' class='fixed flag checkbox "+(a?"on":"off")+"'>"+(a?"on":"off")+"</span></span>",b);this.tab_index++;$(e).find(".wcontent .checkbox").keypress(function(a){32==a.keyCode&&$(this).click()});$(e).click(function(){var a=!this.data;this.data=a;$(e).find("span.flag").html(a?"on":"off");a?$(e).find("span.checkbox").addClass("on"):
$(e).find("span.checkbox").removeClass("on");Inspector.onWidgetChange.call(d,e,c,a,b)})[0].data=a;e.setValue=function(a){d.values[c]!=a&&$(this).find(".checkbox").click()};this.append(e);return e};Inspector.prototype.addFlags=function(c,a){var b={},d;for(d in c)b[d]=c[d];if(a)for(d in a)"undefined"==typeof b[d]&&(b[d]=a[d]?!0:!1);for(d in b)this.addCheckbox(d,b[d],{callback:function(a){return function(b){c[a]=b}}(d)})};
Inspector.prototype.addCombo=function(c,a,b){b=b||{};var d=this;this.values[c]=a;var e="<select tabIndex='"+this.tab_index+"' "+(b.disabled?"disabled":"")+" class='"+(b.disabled?"disabled":"")+"'>";this.tab_index++;var f=this.createWidget(c,"<span class='inputfield full inputcombo "+(b.disabled?"disabled":"")+"'></span>",b);f.options=b;var g=b.values||[];if(b.values&&(g="function"==typeof g?b.values():b.values))for(var h in g)e+="<option "+(g[h]==a?" selected":"")+">"+(g.length?g[h]:h)+"</option>";
e+="</select>";f.querySelector("span.inputcombo").innerHTML=e;$(f).find(".wcontent select").change(function(a){a=a.target.value;g&&g.constructor!=Array&&(a=g[a]);Inspector.onWidgetChange.call(d,f,c,a,b)});this.append(f);return f};
Inspector.prototype.addComboButtons=function(c,a,b){b=b||{};a=a||"";var d=this;this.values[c]=a;var e="";if(b.values)for(var f in b.values)e+="<button class='wcombobutton "+(a==b.values[f]?"selected":"")+"' data-name='options.values[i]'>"+b.values[f]+"</button>";var g=this.createWidget(c,e,b);$(g).find(".wcontent button").click(function(a){a=a.target.innerHTML;d.values[c]=a;$(g).find(".selected").removeClass("selected");$(this).addClass("selected");Inspector.onWidgetChange.call(d,g,c,a,b)});this.append(g);
return g};
Inspector.prototype.addTags=function(c,a,b){function d(a){if(!g.tags[a]){g.tags[a]=!0;var d=document.createElement("div");d.data=a;d.className="wtag";d.innerHTML=a+"<span class='close'>X</span>";$(d).find(".close").click(function(a){a=$(this).parent()[0].data;delete g.tags[a];$(this).parent().remove();$(g).trigger("wremoved",a);Inspector.onWidgetChange.call(e,g,c,g.tags,b)});$(g).find(".wtagscontainer").append(d);e.values[c]=g.tags;b.callback&&b.callback.call(g,g.tags);$(g).trigger("wchange",g.tags);
$(g).trigger("wadded",a);if(e.onchange)e.onchange(c,g.tags,g)}}b=b||{};a=a||[];var e=this;this.values[c]=a;a="<select>";if(b.values)for(var f in b.values)a+="<option>"+b.values[f]+"</option>";var g=this.createWidget(c,"<span class='inputfield full'>"+(a+"</select><div class='wtagscontainer inputfield'></div>")+"</span>",b);g.tags={};for(f in b.value)d(b.value[f]);$(g).find(".wcontent select").change(function(a){d(a.target.value)});this.append(g);return g};
Inspector.prototype.addList=function(c,a,b){function d(a){var b=$(h).find("li.selected");b&&b.length&&(40==a.keyCode?(a=b.next())&&a.length&&$(a[0]).click():38==a.keyCode&&(a=b.prev())&&a.length&&$(a[0]).click())}function e(d){b.multiselection?$(this).toggleClass("selected"):($(h).find("li").removeClass("selected"),$(this).addClass("selected"));d=a[this.dataset.pos];Inspector.onWidgetChange.call(f,h,c,d,b);$(h).trigger("wadded",d)}b=b||{};var f=this,g="";b.height&&(g="style='height: "+b.height+"px; overflow: auto;'");
g="<ul class='lite-list' "+g+" tabIndex='"+this.tab_index+"'><ul>";this.tab_index++;var h=this.createWidget(c,"<span class='inputfield full "+(b.disabled?"disabled":"")+"'>"+g+"</span>",b);$(h).find("ul").focus(function(){$(document).bind("keypress",d)});$(h).find("ul").blur(function(){$(document).unbind("keypress",d)});h.updateItems=function(b){var c="";if(a=b)for(var d in a){b=a[d];var f="";null==a[d].length&&(b=a[d].name?a[d].name:d,a[d].icon&&(f="<img src='"+a[d].icon+"' class='icon' />"));c+=
"<li className='item-"+d+" "+("object"==typeof a[d]&&a[d].selected?"selected":"")+"' data-name='"+b+"' data-pos='"+d+"'>"+f+b+"</li>"}$(this).find("ul").html(c);$(this).find(".wcontent li").click(e)};h.removeItem=function(a){for(var b=$(h).find(".wcontent li"),c=0;c<b.length;c++)b[c].dataset.name==a&&$(b[c]).remove()};h.updateItems(a);this.append(h);b.height&&$(h).scroll(0);return h};
Inspector.prototype.addButton=function(c,a,b){b=b||{};a=a||"";var d=this,e=this.createWidget(c,"<button tabIndex='"+this.tab_index+"'>"+a+"</button>",b);this.tab_index++;$(e).find("button").click(function(){Inspector.onWidgetChange.call(d,e,c,this.innerHTML,b);$(e).trigger("wclick",a)});this.append(e);e.wclick=function(a){b.disabled||$(this).wclick(a)};return e};
Inspector.prototype.addButtons=function(c,a,b){b=b||{};a=a||"";var d=this,e="",f="calc("+(100/a.length).toFixed(3)+"% - "+Math.floor(16/a.length)+"px);";if(a&&"object"==typeof a)for(var g in a)e+="<button tabIndex='"+this.tab_index+"' style=' width:"+f+" width: -moz-"+f+" width: -webkit-calc("+(89/a.length).toFixed(3)+"%)'>"+a[g]+"</button>",this.tab_index++;var h=this.createWidget(c,e,b);$(h).find("button").click(function(){Inspector.onWidgetChange.call(d,h,c,this.innerHTML,b);$(h).trigger("wclick",
this.innerHTML)});this.append(h);return h};
Inspector.prototype.addColor=function(c,a,b){b=b||{};a=a||[0,0,0];var d=this;this.values[c]=a;var e="<input tabIndex='"+this.tab_index+"' id='colorpicker-"+c+"' class='color' value='"+a+"' "+(b.disabled?"disabled":"")+"/>";this.tab_index++;b.show_rgb&&(e+="<span class='rgb-color'>"+Inspector.parseColor(a)+"</span>");var f=this.createWidget(c,e,b);this.append(f);var e=$(f).find("input.color")[0],g=new jscolor.color(e);g.pickerFaceColor="#333";g.pickerBorderColor="black";g.pickerInsetColor="#222";g.rgb_intensity=
1;b.disabled&&(g.pickerOnfocus=!1);"string"!=typeof a&&a.length&&2<a.length&&(g.fromRGB(1*a[0],1*a[1],1*a[2]),g.rgb_intensity=1);$(e).change(function(a){$(f).find(".rgb-color").html(Inspector.parseColor(g.rgb))});g.onImmediateChange=function(){var a=[g.rgb[0]*g.rgb_intensity,g.rgb[1]*g.rgb_intensity,g.rgb[2]*g.rgb_intensity];d.values[c]=a;b.callback&&b.callback.call(f,a.concat(),"#"+g.toString(),g);$(f).trigger("wchange",[a.concat(),g.toString()]);if(d.onchange)d.onchange(c,a.concat(),f)};b.step=
b.step||0.01;b.dragger_class="nano";a=new LiteGUI.Dragger(1,b);$(f).find(".wcontent").append(a.root);$(a.input).change(function(){var a=parseFloat($(this).val());g.rgb_intensity=a;if(g.onImmediateChange)g.onImmediateChange()});return f};
Inspector.prototype.addFile=function(c,a,b){b=b||{};a=a||"";var d=this;this.values[c]=a;var e=this.createWidget(c,"<span class='inputfield full whidden'><span class='filename'>"+a+"</span><input type='file' size='100' class='file' value='"+a+"'/></span>",b);$(e).find(".wcontent input").change(function(a){b.callback&&b.callback.call(e,a.target.value);$(e).find(".filename").html(a.target.value);$(e).trigger("wchange",[a.target.files]);Inspector.onWidgetChange.call(d,e,c,a.target.value,b)});this.append(e);
return e};Inspector.prototype.addLine=function(c,a,b){b=b||{};a=a||"";var d=this;this.values[c]=a;var e=this.createWidget(c,"<span class='line-editor'></span>",b);a=new LiteGUI.LineEditor(a,b);$(e).find("span.line-editor").append(a);$(a).change(function(a){b.callback&&b.callback.call(e,a.target.value);$(e).trigger("wchange",[a.target.value]);Inspector.onWidgetChange.call(d,e,c,a.target.value,b)});this.append(e);return e};
Inspector.prototype.addTree=function(c,a,b){function d(a,b){for(var c in b){var h=document.createElement("div");h.className="treenode";"object"==typeof b[c]?(h.innerHTML="<span class='itemname'>"+c+"</span><span class='itemcontent'></span>",d($(h).find(".itemcontent")[0],b[c])):h.innerHTML="<span class='itemname'>"+c+"</span><span class='itemvalue'>"+b[c]+"</span>";a.appendChild(h)}}b=b||{};a=a||"";c=this.createWidget(c,"<div class='wtree'></div>",b);b=$(c).find(".wtree")[0];d(b,a);this.append(c);
return c};Inspector.parseColor=function(c){return"<span style='color: #FAA'>"+c[0].toFixed(2)+"</span>,<span style='color: #AFA'>"+c[1].toFixed(2)+"</span>,<span style='color: #AAF'>"+c[2].toFixed(2)+"</span>"};LiteGUI.Inspector=Inspector;
